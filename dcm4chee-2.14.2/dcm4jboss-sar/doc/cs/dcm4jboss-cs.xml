<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
"http://www.oasis-open.org/docbook/xml/4.0/docbookx.dtd">
<article status="draft">
  <title>dcm4che/archive v 0.9</title>

  <subtitle>DICOM Conformance Statement</subtitle>

  <articleinfo>
    <corpauthor><ulink url="http://www.tiani.com">TIANI MEDGRAPH
    AG</ulink></corpauthor>

    <pubdate>Sept 2004</pubdate>
  </articleinfo>

  <abstract>
    <title>Overview</title>

    <para>Dcm4che/archive is a system that provides services for safe storage
    and retrieve of DICOM evidence object such Images, Key Image Notes,
    Presentation States, Structured Reports and others.</para>

    <para>Dcm4che/archive supports the following IHE Integration
    Profiles:</para>

    <para>- Access to Radiology Information</para>

    <para>- Consistent Presentation of Images</para>

    <para>- Evidence Documents</para>

    <para>- Key Image Note</para>

    <para>- Patient Information Reconciliation</para>

    <para>- Simple Image and Numeric Report</para>

    <para>- Scheduled Workflow</para>

    <para>- Basic Security</para>

    <para>Dcm4che/archive supports the following network services:<table>
        <title>NETWORK SERVICES</title>

        <tgroup align="left" cols="3">
          <colspec colname="c1" />

          <colspec align="center" colname="c2" colwidth="60" />

          <colspec align="center" colname="c3" colwidth="60" />

          <spanspec nameend="c3" namest="c1" spanname="c1-3" />

          <thead>
            <row>
              <entry>Networking SOP Classes</entry>

              <entry>User of Service (SCU)</entry>

              <entry>Provider of Service (SCP)</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry spanname="c1-3"><emphasis>Transfer</emphasis></entry>
            </row>

            <row>
              <entry>US Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>US Multi-frame Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Computed Radiography Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital X-Ray Image Storage - For Presentation</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital X-Ray Image Storage - For Processing</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital Mammography X-Ray Image Storage - For
              Presentation</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital Mammography X-Ray Image Storage - For
              Preocessing</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital Intra-oral X-Ray Image Storage - For
              Presentation</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Digital Intra-oral X-Ray Image Storage - For
              Processing</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>CT Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>MR Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Enhanced MR Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Secondary Capture Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>X-Ray Angiographic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>X-Ray Radiofluoroscopic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Nuclear Medicine Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>VL Endoscopic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>VL Microscopic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>VL Slide-Coordinates Microscopic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>VL Photographic Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Positron Emission Tomography Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>RT Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Raw Data Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Multi-frame Grayscale Byte Secondary Capture Image
              Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Multi-frame Grayscale Word Secondary Capture Image
              Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Multi-frame Color Secondary Capture Image Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Grayscale Softcopy Presentation State Storage</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Hardcopy Grayscale Image Storage SOP Class</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Hardcopy Color Image Storage SOP Class</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Basic Text SR</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Enhanced SR</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Comprehensive SR</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Key Object Selection Document</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Storage Commitment Push Model</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry spanname="c1-3"><emphasis>Workflow
              Management</emphasis></entry>
            </row>

            <row>
              <entry>Modality Worklist - FIND</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Modality Performed Procedure Step</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Instance Availability Notification</entry>

              <entry>Yes</entry>

              <entry>No</entry>
            </row>

            <row>
              <entry>Basic Study Content Notification</entry>

              <entry>Yes</entry>

              <entry>No</entry>
            </row>

            <row>
              <entry
              spanname="c1-3"><emphasis>Query/Retrieve</emphasis></entry>
            </row>

            <row>
              <entry>Patient Root Q/R - FIND</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Patient Root Q/R - MOVE</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Study Root Q/R - FIND</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Study Root Q/R - MOVE</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Patient/Study Only Q/R - FIND</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry>Patient/Study Only Q/R - MOVE</entry>

              <entry>No</entry>

              <entry>Yes</entry>
            </row>

            <row>
              <entry spanname="c1-3"><emphasis>Connectivity
              Verification</emphasis></entry>
            </row>

            <row>
              <entry>Verification</entry>

              <entry>Yes</entry>

              <entry>Yes</entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>

    <para></para>
  </abstract>

  <section>
    <title>Introduction</title>

    <section>
      <title>Revision History</title>

      <para><revhistory>
          <revision>
            <revnumber>0.1</revnumber>

            <date>Feb 2004</date>

            <authorinitials>uc</authorinitials>

            <revremark>Initial draft</revremark>
          </revision>

          <revision>
            <revnumber>0.2</revnumber>

            <date>Mar 2004</date>

            <authorinitials>uc</authorinitials>

            <revremark>Initial draft</revremark>
          </revision>

          <revision>
            <revnumber>0.3</revnumber>

            <date>May 2004</date>

            <authorinitials>hm</authorinitials>

            <revremark>ad MWL section, update configuration
            section</revremark>
          </revision>

          <revision>
            <revnumber>0.4</revnumber>

            <date>Sep 2004</date>

            <authorinitials>gz</authorinitials>

            <revremark>ad IAN, SCN, compression</revremark>
          </revision>
        </revhistory></para>
    </section>

    <section>
      <title>Audience</title>

      <para>This document is intended for hospital staff, health system
      integrators, software designers or implementers. It is assumed that the
      reader has a working understanding of DICOM.</para>
    </section>

    <section>
      <title>Remarks</title>

      <para>DICOM, by itself, does not guarantee interoperability. However,
      the Conformance Statement facilitates a first-level validation for
      interoperability between different applications supporting the same
      DICOM functionality.</para>

      <para>This Conformance Statement is not intended to replace validation
      with other DICOM equipment to ensure proper exchange of information
      intended.</para>

      <para>The scope of this Conformance Statement is to facilitate
      communication with TIANI and other vendors' medical equipment. The
      Conformance Statement should be read and understood in conjunction with
      the DICOM Standard [DICOM]. However, by itself it is not guaranteed to
      ensure the desired interoperability and successful interconnectivity
      with existing DICOM systems.</para>

      <para>The user should be aware of the following important issues:</para>

      <itemizedlist>
        <listitem>
          <para>The comparison of different conformance statements is the
          first step towards assessing interconnectivity between TIANI and
          non-TIANI equipment.</para>
        </listitem>

        <listitem>
          <para>Test procedures should be defined to validate the desired
          level of connectivity.</para>
        </listitem>

        <listitem>
          <para>The DICOM standard will evolve to meet the users' future
          requirements. TIANI is actively involved in developing the standard
          further and therefore reserves the right to make changes to its
          products or to discontinue its delivery.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Definitions, Terms and Abbreviations</title>

      <para>Definitions, terms and abbreviations used in this document are
      defined within the different parts of the DICOM standard.</para>

      <para>Abbreviations and terms are as follows:<variablelist>
          <varlistentry>
            <term>AE</term>

            <listitem>
              <para>DICOM Application Entity</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>AET</term>

            <listitem>
              <para>Application Entity Title</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>DICOM</term>

            <listitem>
              <para>Digital Imaging and Communications in Medicine</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>DIMSE</term>

            <listitem>
              <para>DICOM Message Service Element</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>GSDF</term>

            <listitem>
              <para>Grayscale Standard Display Function</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>HIS/RIS</term>

            <listitem>
              <para>Hospital Information System / Radiology Information
              System.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>IHE</term>

            <listitem>
              <para>Integrating the Healthcare Enterprise</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>IHE-TF</term>

            <listitem>
              <para>Integrating the Healthcare Enterprise Technical
              Framework</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>IAN</term>

            <listitem>
              <para>Instance Availability Notification</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>IOD</term>

            <listitem>
              <para>Information Object Definition</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>ISO</term>

            <listitem>
              <para>International Standard Organization</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>PDU</term>

            <listitem>
              <para>DICOM Protocol Data Unit</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>LUT</term>

            <listitem>
              <para>Look-up Table</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>MPPS</term>

            <listitem>
              <para>Modality Performed Procedure Step</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>MWL</term>

            <listitem>
              <para>Modality Worklist</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>P-LUT</term>

            <listitem>
              <para>Presentation Look-up Table</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>Q/R</term>

            <listitem>
              <para>Query Retrieve</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>SCP</term>

            <listitem>
              <para>Service Class Provider</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>SCU</term>

            <listitem>
              <para>Service Class User</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>SCN</term>

            <listitem>
              <para>Study Content Notification</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>SOP</term>

            <listitem>
              <para>DICOM Service-Object Pair</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>TCP/IP</term>

            <listitem>
              <para>Transmission Control Protocol/Internet Protocol</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>TLS</term>

            <listitem>
              <para>Transport Layer Security</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>UID</term>

            <listitem>
              <para>Unique Identifier</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>VR</term>

            <listitem>
              <para>Value Representation</para>
            </listitem>
          </varlistentry>
        </variablelist></para>
    </section>

    <section>
      <title>References</title>

      <para><variablelist>
          <varlistentry>
            <term>[DICOM]</term>

            <listitem>
              <para>Digital Imaging and Communications in Medicine (DICOM),
              NEMA PS 3.1- 3.16, 2001</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>[IHE-TF]</term>

            <listitem>
              <para>Integrating the Healthcare Enterprise Technical Framework,
              HIMSS/RSNA, Revision 5.4, 2002</para>
            </listitem>
          </varlistentry>
        </variablelist></para>
    </section>
  </section>

  <section>
    <title>Networking</title>

    <section>
      <title>Implementation Model</title>

      <section>
        <title>Application Data Flow</title>

        <para>dcm4che/archive is logically divided in 4 different DICOM
        Application Entities: Storage Server, Query/Retrieve Server, MPPS
        Manager and IAN/SCN Service.</para>

        <para>The Application Entities detailed in the Application Data Flow
        Diagram are all Java Enterprise Application and are designed to run in
        a J2EE compliant container (i.e. JBoss) on any Java Virtual Machine
        1.4 capable Operating System.</para>

        <para><figure>
            <title>Application Data Flow Diagram</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="app_flow_diagram.gif" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>The Storage Server AE implements the DICOM Storage Service
        Class, the Verification Service Class and the DICOM Storage Commitment
        Service as SCU and as SCP</para>

        <para>The Query/Retrieve Server AE implements Query/Retrieve
        Services.</para>

        <para>The Modality Worklist Server AE implements the Verification
        Service Class and the Basic Worklist Management Service Class.</para>

        <para>The MPPS manager AE implements the DICOM Modality Performed
        Procedure Step Service.</para>

        <para>The IAN/SCN service implements the DICOM Instance Availability
        Notification and the Basic Study Content Notification as SCU.</para>
      </section>

      <section>
        <title>Functional Definition of AEs</title>

        <section>
          <title>Functional Definition of dcm4che/archive Storage Server
          Application Entity</title>

          <para>The dcm4che/archive Storage Server Application Entity waits
          for another application to connect at the presentation address
          configured for its Application Entity Title. When another
          application connects, the STORAGE-SCP AE expects it to be a DICOM
          application.</para>

          <para>The STORAGE-SCP AE will accept Associations with Presentation
          Contexts for SOP Classes of the Verification, Storage, and Storage
          Commitment Service Classes.</para>

          <para>DICOM Instances received in a Storage Request are filed on
          local (attached/mounted) file system(s). A subset of attributes from
          received Instances is also stored in records local database.</para>
        </section>

        <section>
          <title>Functional Definition of dcm4che/archive Query/Retrieve
          Server Application Entity</title>

          <para>The dcm4che/archive Query/Retrieve Server Application Entity
          waits for another application to connect at the presentation address
          configured for its Application Entity Title. When another
          application connects, the Storage Server AE expects it to be a DICOM
          application.</para>

          <para>The Query/Retrieve Server AE will accept Associations with
          Presentation Contexts for SOP Classes of the Verification and
          Query/Retrieve Service Classes.</para>

          <para>Once received a Retrieve (Move) request, Query/Retrieve Server
          AE will initiate a new association and send the requested instances
          to the Move Destination AE.</para>
        </section>

        <section>
          <title>Functional Definition of dcm4che/archive Modality Worklist
          Server Application Entity</title>

          <para>The dcm4che/archive Modality Worklist Server Application
          Entity waits for another application to connect at the presentation
          address configured for its Application Entity Title. When another
          application connects, the Modality Worklist Server AE expects it to
          be a DICOM application.</para>

          <para>The Modality Worklist Server AE will accept Associations with
          Presentation Contexts for SOP Classes of the Verification and
          Modality Worklist Service Classes.</para>

          <para>When a Modality Worklist Find request is received, Modality
          Worklist Server AE will query the local database for a list of
          Scheduled Procedure Steps matching the query and will return a
          pending C-Find response for each match.</para>

          <para>Before patient and order information can be included in
          response to a Modality Worklist query, Modality Worklist items must
          be created by ...</para>
        </section>

        <section>
          <title>Functional Definition of dcm4che/archive MPPS Manager
          Application Entity</title>

          <para>The dcm4che/archive MPPS Manager Application Entity waits for
          another application to connect at the presentation address
          configured for its Application Entity Title. When another
          application connects, the MPPS Manager AE expects it to be a DICOM
          application.</para>

          <para>The MPPS Manager AE will accept Associations with Presentation
          Contexts for SOP Classes of the Verification and Modality Performed
          Procedure Step Service Classes.</para>

          <para>The MPPS Manager stores the received MPPS instances in the
          local database and can be configured to forward them to a remote
          MPPS SCP.</para>
        </section>

        <section>
          <title>Functional Definition of dcm4che/archive IAN/SCN Application
          Entity</title>

          <para>The dcm4che/archive IAN/SCN Application Entity notifies a
          configurable list of remote DICOM peer application, about new
          instances received by the Storage Server AE, triggered by the
          release of the association to the Storage Server AE.</para>

          <para>It will initiate a new association to the remote AE which
          shall be notified, offering a Presentation Context for the Instance
          Availibility Notification SOP Class or for the Basic Study Content
          Notification SOP Class or for both - dependend of its configuration
          and perform the notification for each study received by the Storage
          Server AE in the released association, using the accepted
          service.</para>
        </section>
      </section>

      <section id="s-sequencing">
        <title>Sequencing of Real-World Activities</title>

        <para>Note that the only constraint is for the Composite SOP Instance
        to be received prior to the other events. All the other events (even
        MPPS Send) are not constrained and can happen at any time.</para>

        <para><figure>
            <title>Sequencing Constraints</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="sequencing_diagram.gif" />
              </imageobject>
            </mediaobject>
          </figure></para>
      </section>
    </section>

    <section>
      <title>AE Specifications</title>

      <section>
        <title>dcm4che/archive Storage Server Application Entity
        Specification</title>

        <section>
          <title>SOP Classes</title>

          <para>dcm4che/archive Storage Server Application Entity provides
          Standard Conformance to the following SOP Classes:</para>

          <table>
            <title>SOP Classes for dcm4che/archive Storage Server AE</title>

            <tgroup align="left" cols="4">
              <colspec align="left" colname="c1" />

              <colspec align="left" colname="c2" colwidth="120" />

              <colspec align="center" colname="c3" colwidth="25" />

              <colspec align="center" colname="c4" colwidth="25" />

              <thead>
                <row>
                  <entry>SOP Class Name</entry>

                  <entry>SOP Class UID</entry>

                  <entry>SCU</entry>

                  <entry>SCP</entry>
                </row>
              </thead>

              <tbody>
                <row>
                  <entry>Verification SOP Class</entry>

                  <entry>1.2.840.10008.1.1</entry>

                  <entry>Yes</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Storage Commitment Push Model SOP Class</entry>

                  <entry>1.2.840.10008.1.20.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Hardcopy Grayscale Image Storage SOP Class</entry>

                  <entry>1.2.840.10008.5.1.1.29</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Hardcopy Color Image Storage SOP Class</entry>

                  <entry>1.2.840.10008.5.1.1.30</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Computed Radiography Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital X-Ray Image Storage - For
                  Presentation</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital X-Ray Image Storage - For Processing</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.1.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital Mammography X-Ray Image Storage - For
                  Presentation</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.2</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital Mammography X-Ray Image Storage - For
                  Processing</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.2.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital Intra-oral X-Ray Image Storage - For
                  Presentation</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.3</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Digital Intra-oral X-Ray Image Storage - For
                  Processing</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.1.3.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>CT Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.2</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Ultrasound Multi-frame Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.3.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>MR Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.4</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Enhanced MR Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.4.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Ultrasound Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.6.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Secondary Capture Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.7</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Multi-frame Grayscale Byte Secondary Capture Image
                  Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.7.2</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Multi-frame Grayscale Word Secondary Capture Image
                  Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.7.3</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Multi-frame Color Secondary Capture Image
                  Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.7.4</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>X-Ray Angiographic Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.12.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>X-Ray Radiofluoroscopic Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.12.2</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Nuclear Medicine Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.20</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Raw Data Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.66</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>VL Endoscopic Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.77.1.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>VL Microscopic Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.77.1.2</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>VL Slide-Coordinates Microscopic Image
                  Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.77.1.3</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>VL Photographic Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.77.1.4</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Positron Emission Tomography Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.128</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>RT Image Storage</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.481.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Grayscale Softcopy Presentation State Storage SOP
                  Class</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.11.1</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Basic Text SR</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.88.11</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Enhanced SR</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.88.22</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Comprehensive SR</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.88.33</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>

                <row>
                  <entry>Key Object Selection Document</entry>

                  <entry>1.2.840.10008.5.1.4.1.1.88.59</entry>

                  <entry>No</entry>

                  <entry>Yes</entry>
                </row>
              </tbody>
            </tgroup>
          </table>
        </section>

        <section>
          <title>Association Establishment Policy</title>

          <section>
            <title>General</title>

            <para>The dcm4che/archive Storage Server AE can both accept and
            propose Association Requests. The dcm4che/archive Storage Server
            AE will accept Association Requests for the Verification, Storage,
            and Storage Commitment Push Model Services. It will propose
            Associations only for the Storage Commitment Push Model
            Service.</para>

            <para>The DICOM standard application context name for DICOM 3.0 is
            always accepted and proposed:</para>

            <table>
              <title>DICOM application context name for dcm4che/archive
              Storage Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Application Context Name</entry>

                    <entry>1.2.840.10008.3.1.1.1</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Number of Associations</title>

            <para>dcm4che/archive Storage Server can support multiple
            simultaneous Associations requested by peer AEs. Default is 10.
            This value can be configured through the attribute "MaxClients" in
            the Application Server configuration file (i.e. jboss-service.xml
            for JBoss application seerver).</para>

            <table>
              <title>Number of Associations accepted for dcm4che/archive
              Storage Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of simultaneous Associations</entry>

                    <entry>10 (Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Asynchronous Nature</title>

            <para>dcm4che/archive Storage Server does not support asynchronous
            communication. Multiple outstanding transactions are not
            supported. It allows up to one invoked and one performed operation
            on an Association (it is synchronous). Asynchronous mode of
            operation is not supported.</para>

            <table>
              <title>Asynchronous Nature as SCP for dcm4che Storage Server
              AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of outstanding asynchronous
                    transactions</entry>

                    <entry>1 (Not Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Implementation Identifying Information</title>

            <para>The implementation information for this Application Entity
            is:</para>

            <table>
              <title>DICOM Implementation Class and Version for dcm4che
              Storage Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Implementation Class UID</entry>

                    <entry>1.2.40.0.13.1.1</entry>
                  </row>

                  <row>
                    <entry>Implementation Version Name</entry>

                    <entry>dcm4che-1.1</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>
        </section>

        <section>
          <title>Association Initiation Policy</title>

          <section>
            <title>Activity - Send Storage Commitment Notification over new
            Association</title>

            <section>
              <title>Description and Sequencing of Activities</title>

              <para>An Association Request is sent to the peer AE that sent
              the Storage Commitment Push Model request and upon successful
              negotiation of the required Presentation Context the outstanding
              N-EVENT-REPORT is sent.</para>

              <section>
                <title>Proposed Presentation Contexts</title>

                <para>dcm4che/archive Storage Server will propose Presentation
                Contexts as shown in the following table:<table>
                    <title>Proposed Presentation Contexts by the
                    dcm4che/archive Storage Server AE</title>

                    <tgroup align="left" cols="6">
                      <colspec colname="c1" />

                      <colspec colname="c2" colwidth="110" />

                      <colspec colname="c3" colwidth="60" />

                      <colspec colname="c4" colwidth="90" />

                      <colspec align="center" colname="c5" colwidth="30" />

                      <colspec align="center" colname="c6" colwidth="30" />

                      <spanspec align="center" nameend="c2" namest="c1"
                                spanname="s12" />

                      <spanspec align="center" nameend="c4" namest="c3"
                                spanname="s34" />

                      <thead>
                        <row valign="middle">
                          <entry spanname="s12">Abstract Syntax</entry>

                          <entry spanname="s34">Transfer Syntax</entry>

                          <entry morerows="1">Role</entry>

                          <entry morerows="1">Ext. Neg.</entry>
                        </row>

                        <row>
                          <entry>Name</entry>

                          <entry>UID</entry>

                          <entry>Name List</entry>

                          <entry>UID List</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Verification</entry>

                          <entry>1.2.840.10008.1.1</entry>

                          <entry>Implicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2</entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry morerows="1">Storage Commitment Push
                          Model</entry>

                          <entry morerows="1">1.2.840.10008.1.20.1.1.1</entry>

                          <entry>Implicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2</entry>

                          <entry morerows="1">SCP</entry>

                          <entry morerows="1">None</entry>
                        </row>

                        <row>
                          <entry>Explicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2.1</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table></para>

                <section>
                  <title>SOP Specific Conformance</title>

                  <section>
                    <title>Specific Conformance for Verification SOP
                    Class</title>

                    <para>Standard conformance is provided to the DICOM
                    Verification Service Class as an SCU. The Verification
                    Service as an SCU is actually only supported as a
                    diagnostic service tool for network communication issues.
                    It can be used to test whether Associations can actually
                    be opened with a peer AE that is issuing Storage
                    Commitment Push Model requests (i.e. to test whether the
                    indicated TCP/IP port and AE Title for sending
                    N-EVENT-REPORT Requests to the peer AE are truly
                    functional).</para>
                  </section>

                  <section>
                    <title>Specific Conformance for Storage Commitment SOP
                    Classes</title>

                    <para>The associated Activity with the Storage Commitment
                    Push Model service is the communication by the
                    dcm4che/archive Storage Server AE to peer AEs that it has
                    committed to permanently store Composite SOP Instances
                    that have been sent to it.</para>

                    <para>It thus allows peer AEs to determine whether the
                    dcm4che/archive Storage Server has taken responsibility
                    for the archiving of specific SOP Instances so that they
                    can be flushed from the peer AE system.</para>
                  </section>
                </section>
              </section>
            </section>
          </section>
        </section>

        <section>
          <title>Association Acceptance Policy</title>

          <section>
            <title>Activity - Receive Images and Storage Commitment
            Requests</title>

            <section>
              <title>Description and Sequencing of Activities</title>

              <para>A remote peer DICOM Application Entity, acting as an
              Storage SCU, establishes an association with dcm4che/archive
              Storage Server that accepts these Associations for the purpose
              of receiving supported SOP Class Instances and Storage
              Committment requests.</para>

              <para>In the default configuration any Calling and Called AET
              will be accepted. But the Called AET does not correspond to the
              actual Storage Server AET, only a Presentation Context for the
              Verification SOP Class will be accepted and the SCU can only
              verify the DICOM Association, but cannot invoke any other
              related DICOM service.</para>

              <para>When an association has been established the Sequencing of
              Real-World Activities is as described in <xref
              linkend="s-sequencing" />.</para>

              <para>The Storage Server AE may reject Association attempts as
              shown in the table below. The Result, Source and Reason / Diag
              columns represent the values returned in the corresponding
              fields of an ASSOCIATE-RJ PDU (see PS 3.8, Section
              9.3.4).</para>

              <table>
                <title>Association Rejection Reasons</title>

                <tgroup align="left" cols="4">
                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <thead>
                    <row>
                      <entry>Result</entry>

                      <entry>Source</entry>

                      <entry>Reason</entry>

                      <entry>Description</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>2 - rejected transient</entry>

                      <entry>provider</entry>

                      <entry>2 - local-limit exceeded</entry>

                      <entry>The (configurable) maximum number of simultaneous
                      associations has been reached. An association request
                      with the same parameters may succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>2 - application context name not
                      supported</entry>

                      <entry>The Association request contained an unsupported
                      Application Context Name. An association request with
                      the same parameters will NOT succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>3 – calling AE title not recognized</entry>

                      <entry>The Association request contained an unrecognized
                      Calling AE Title. An association request with the same
                      parameters will NOT succeed at a later time unless
                      configuration changes are made.</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>
            </section>

            <section>
              <title>Accepted Presentation Contexts</title>

              <table>
                <title>Accepted Presentation Contexts for dcm4che/archive
                Storage Server AE</title>

                <tgroup align="left" cols="6">
                  <colspec colname="c1" />

                  <colspec colname="c2" colwidth="110" />

                  <colspec colname="c3" colwidth="60" />

                  <colspec colname="c4" colwidth="90" />

                  <colspec align="center" colname="c5" colwidth="30" />

                  <colspec align="center" colname="c6" colwidth="30" />

                  <spanspec align="center" nameend="c2" namest="c1"
                            spanname="s12" />

                  <spanspec align="center" nameend="c4" namest="c3"
                            spanname="s34" />

                  <thead>
                    <row valign="middle">
                      <entry spanname="s12">Abstract Syntax</entry>

                      <entry spanname="s34">Transfer Syntax</entry>

                      <entry morerows="1">Role</entry>

                      <entry morerows="1">Ext. Neg.</entry>
                    </row>

                    <row>
                      <entry>Name</entry>

                      <entry>UID</entry>

                      <entry>Name List</entry>

                      <entry>UID List</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Verification SOP Class</entry>

                      <entry>1.2.840.10008.1.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Storage Commitment Push Model</entry>

                      <entry>1.2.840.10008.1.20.1</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Hardcopy Grayscale Image Storage SOP
                      Class</entry>

                      <entry>1.2.840.10008.5.1.1.29</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Hardcopy Color Image Storage SOP Class</entry>

                      <entry>1.2.840.10008.5.1.1.30</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Computed Radiography Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital X-Ray Image Storage - For
                      Presentation</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital X-Ray Image Storage - For
                      Processing</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.1.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital Mammography X-Ray Image Storage - For
                      Presentation</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.2</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital Mammography X-Ray Image Storage - For
                      Processing</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.2.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital Intra-oral X-Ray Image Storage - For
                      Presentation</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.3</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Digital Intra-oral X-Ray Image Storage - For
                      Processing</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.1.3.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>CT Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.2</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Ultrasound Multi-frame Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.3.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>MR Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.4</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Enhanced MR Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.4.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Ultrasound Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.6.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Secondary Capture Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.7</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>X-Ray Angiographic Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.12.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>X-Ray Radiofluoroscopic Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.12.2</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Nuclear Medicine Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.20</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Raw Data Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.66</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>VL Endoscopic Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.77.1.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>VL Microscopic Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.77.1.2</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>VL Slide-Coordinates Microscopic Image
                      Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.77.1.3</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>VL Photographic Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.77.1.4</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Positron Emission Tomography Image
                      Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.128</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>RT Image Storage</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.481.1</entry>

                      <entry spanname="s34"><link linkend="t-tsimage">Transfer
                      Syntaxes for Image Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Grayscale Softcopy Presentation State Storage SOP
                      Class</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.11.1</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Basic Text SR</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.88.11</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Enhanced SR</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.88.22</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Comprehensive SR</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.88.33</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry>Key Object Selection Document</entry>

                      <entry>1.2.840.10008.5.1.4.1.1.88.59</entry>

                      <entry spanname="s34"><link
                      linkend="t-tsnoimage">Transfer Syntaxes for Non-Image
                      Storage Services</link></entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>

              <table id="t-tsnoimage">
                <title>Accepted Transfer Syntaxes for Non-Image Storage
                Services</title>

                <tgroup cols="2">
                  <colspec colwidth="200" />

                  <colspec colwidth="120" />

                  <thead>
                    <row>
                      <entry>Name</entry>

                      <entry>UID</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>

              <table id="t-tsimage">
                <title>Accepted Transfer Syntaxes for Image Storage
                Services</title>

                <tgroup cols="2">
                  <colspec colwidth="200" />

                  <colspec colwidth="120" />

                  <thead>
                    <row>
                      <entry>Name</entry>

                      <entry>UID</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry>JPEG Baseline</entry>

                      <entry>1.2.840.10008.1.2.4.50</entry>
                    </row>

                    <row>
                      <entry>JPEG Extended</entry>

                      <entry>1.2.840.10008.1.2.4.51</entry>
                    </row>

                    <row>
                      <entry>JPEG Lossless, Non-Hierarchical</entry>

                      <entry>1.2.840.10008.1.2.4.57</entry>
                    </row>

                    <row>
                      <entry>JPEG Lossless, Non-Hierarchical, First-Order
                      Prediction</entry>

                      <entry>1.2.840.10008.1.2.4.70</entry>
                    </row>

                    <row>
                      <entry>JPEG-LS Lossless Image Compression</entry>

                      <entry>1.2.840.10008.1.2.4.80</entry>
                    </row>

                    <row>
                      <entry>JPEG-LS Lossy (Near-Lossless) Image</entry>

                      <entry>1.2.840.10008.1.2.4.81</entry>
                    </row>

                    <row>
                      <entry>JPEG 2000 Image Compression (Lossless
                      Only)</entry>

                      <entry>1.2.840.10008.1.2.4.90</entry>
                    </row>

                    <row>
                      <entry>JPEG 2000 Image Compression</entry>

                      <entry>1.2.840.10008.1.2.4.91</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>

              <para>If the Called AET is not corresponding to the actual
              Storage Server AET, it only will be accepted the Presentation
              Context for the Verification SOP Class.</para>
            </section>

            <section>
              <title>SOP Specific Conformance</title>

              <section>
                <title>Specific Conformance for Verification SOP Class</title>

                <para>dcm4che/archive Storage Server provides standard
                conformance to the DICOM Verification Service Class as a SCP.
                The status code for the C-ECHO is described in the following
                table:</para>

                <table>
                  <title>C-Echo Response Status Handling Behavior</title>

                  <tgroup align="left" cols="4">
                    <colspec colwidth="40" />

                    <colspec colwidth="100" />

                    <colspec colwidth="40" />

                    <thead>
                      <row valign="middle">
                        <entry>Service Status</entry>

                        <entry>Further Meaning</entry>

                        <entry>Error Code</entry>

                        <entry>Behavior</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry>Success</entry>

                        <entry>Success</entry>

                        <entry>0000</entry>

                        <entry>The C-ECHO request is accepted</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table>
              </section>

              <section>
                <title>Specific Conformance for Storage SOP Classes</title>

                <para>The associated Activity with the Storage service is the
                storage of medical DICOM data received over the network on a
                designated storage repository. The dcm4che Storage Server AE
                will return a failure status if it is unable to store the
                received instance(s).</para>

                <para>The dcm4che/archive Storage Server AE does not have any
                dependencies on the number of Associations used to send images
                to it. Images belonging to more than one Study or Series can
                be sent over a single or multiple Associations. Images
                belonging to a single Study or Series can also be sent over
                different Associations. There is no limit on either the number
                of SOP Instances or the maximum amount of total SOP Instance
                data that can be transferred over a single Association.</para>

                <para>The dcm4che/archive Storage Server AE is configured to
                retain the original DICOM data in DICOM Part 10 compliant file
                format. The dcm4che/archive Storage Server AE is Level 2
                (Full) conformant as a Storage SCP. In addition, all Private
                and SOP Class Extended Elements are maintained in the DICOM
                format files. In addition to saving all Elements in files, a
                subset of the Elements are stored in the dcm4che/archive
                Query/Retrieve Server database to support query and retrieval
                requests and also allow updating of Patient, Study, and Series
                information by user input, or demographic and Study related
                messages.</para>

                <para>TIf the received instance is a duplicate of a previously
                received instance, the old file and database information will
                not be overwritten with the new one.</para>

                <para>The average throughput performance has been determined
                to be between 2 and 6 Mega Bytes per second on a 100 Megabit
                Ethernet network. Actual performance will depend greatly on
                the performance of the CSTORE SCU, the number of simultaneous
                active Associations, and the underlying network performance.
                ??TOVERIFY</para>

                <section>
                  <title>Storage Server AE C-STORE Response</title>

                  <para><table>
                      <title>dcm4che Storage Server C-STORE Response
                      Status</title>

                      <tgroup align="left" cols="4">
                        <colspec colwidth="40" />

                        <colspec colwidth="80" />

                        <colspec colwidth="40" />

                        <thead>
                          <row valign="middle">
                            <entry>Service Status</entry>

                            <entry>Further Meaning</entry>

                            <entry>Error Code</entry>

                            <entry>Behavior</entry>
                          </row>
                        </thead>

                        <tbody>
                          <row>
                            <entry>Success</entry>

                            <entry>Success</entry>

                            <entry>0000</entry>

                            <entry>The Composite SOP Instance was successfully
                            received, verified, and stored in the system
                            repository.</entry>
                          </row>

                          <row>
                            <entry>Error</entry>

                            <entry>Processing Failure</entry>

                            <entry>0110</entry>

                            <entry>This status is returned due to internal
                            errors such as a processing failure response from
                            the internal database or a filesystem operation. The
                            appropriate Status will be sent in the C-STORE
                            Response. Error indication message is output to the
                            Service Log.</entry>
                          </row>

                          <row>
                            <entry>Warning</entry>

                            <entry>Coercion of Data Elements</entry>

                            <entry>B000</entry>

                            <entry>This status is returned if one or more
                            Attribute values were coerced/modified on reception.
                            Image transmission is considered successful. The
                            appropriate SUCCESS Status will be sent in the
                            C-STORE Response. Warning indication message is
                            output to the Service Log.</entry>
                          </row>

                          <row>
                            <entry>Warning</entry>

                            <entry>Data Set does not match SOP class</entry>

                            <entry>B007</entry>

                            <entry>This status is returned if the C-STORE
                            Request specifies Attributes that are not specific
                            as part of the Storage SOP class. Image transmission
                            is considered successful. The appropriate SUCCESS
                            Status will be sent in the C-STORE Response. Warning
                            indication message is output to the Service
                            Log.</entry>
                          </row>
                        </tbody>
                      </tgroup>
                    </table></para>
                </section>

                <section>
                  <title>Storage Server AE Storage Service Communication
                  Failure Reasons</title>

                  <para><table>
                      <title>dcm4che Storage Server Service Communication
                      Failure Reasons</title>

                      <tgroup align="left" cols="2">
                        <colspec colwidth="50%" />

                        <colspec colwidth="50%" />

                        <thead>
                          <row valign="middle">
                            <entry>Exception</entry>

                            <entry>Reason</entry>
                          </row>
                        </thead>

                        <tbody>
                          <row>
                            <entry>Timeout expiry for an expected DICOM Message
                            Request (DIMSE level timeout). I.e. The STORAGE-SCP
                            AE is waiting for the next C-STORE Request on an
                            open Association but the timer expires.</entry>

                            <entry>The Association is aborted by issuing a DICOM
                            A-ABORT. Error message is output to the Service Log.
                            If some Composite SOP Instances have already been
                            successfully received then they are maintained in
                            the database. They are not automatically discarded
                            because of a later failure.</entry>
                          </row>

                          <row>
                            <entry>Timeout expiry for an expected DICOM PDU or
                            TCP/IP packet (Low-level timeout). I.e. The
                            STORAGE-SCP AE is waiting for the next C-STORE Data
                            Set PDU but the timer expires.</entry>

                            <entry>The Association is aborted by issuing a DICOM
                            A-ABORT. Error message is output to the Service Log.
                            If a C-STORE Data Set has not been fully received
                            then the data already received is discarded. If some
                            Composite SOP Instances have already been
                            successfully received over the Association then they
                            are maintained in the database.</entry>
                          </row>

                          <row>
                            <entry>Association aborted by the SCU or the network
                            layers indicate communication loss (i.e. low-level
                            TCP/IP socket closure)</entry>

                            <entry>Error message is output to the Service Log.
                            If some Composite SOP Instances have already been
                            successfully received then they are maintained in
                            the database. They are not automatically discarded
                            because of a later failure.</entry>
                          </row>
                        </tbody>
                      </tgroup>
                    </table></para>
                </section>

                <section>
                  <title>Specific Conformance for Storage Commitment SOP
                  Class</title>

                  <para>The associated Activity with the Storage Commitment
                  Push Model service is the communication by the dcm4che
                  Storage Server AE to peer AEs that it has committed to
                  permanently store Composite SOP Instances that have been
                  sent to it. It thus allows peer AEs to determine whether the
                  dcm4che Query/Retrieve Server has taken responsibility for
                  the archiving of specific SOP Instances so that they can be
                  flushed from the peer AE system.</para>

                  <para>The dcm4che Storage Server AE takes the list of
                  Composite SOP Instance UIDs specified in a Storage
                  Commitment Push Model N-ACTION Request and checks if they
                  are present in the dcm4che query/retrieve Server repository.
                  As long as the Composite SOP Instance UIDs are present in
                  the database, the dcm4che Storage Server AE will consider
                  those Composite SOP Instance UIDs to be successfully
                  archived. The dcm4che Storage Server AE does not require the
                  Composite SOP Instances to actually be successfully written
                  to archive media in order to commit to responsibility for
                  maintaining these SOP Instances.</para>

                  <para>Once the dcm4che Storage Server AE has checked for the
                  existence of the specified Composite SOP Instances, it will
                  then attempt to send the Notification request
                  (N-EVENT-REPORT-RQ). The dcm4che Storage Server AE will
                  request a new Association with the peer AE that made the
                  original N-ACTION Request.</para>

                  <para>The dcm4che Storage Server AE will not cache Storage
                  Commitment Push Model N-ACTION Requests that specify
                  Composite SOP Instances that have not yet been transferred
                  to the dcm4che Query/Retrieve Server. If a peer AE sends a
                  Storage Commitment Push Model N-ACTION Request before the
                  specified Composite SOP Instances are later sent over the
                  same Association, the dcm4che Storage Server AE will not
                  commit to responsibility for such SOP Instances.</para>

                  <para>The dcm4che Storage Server AE does not support the
                  optional Storage Media File-Set ID &amp; UID attributes in
                  the N-ACTION.</para>

                  <para>The dcm4che Storage Server AE will support Storage
                  Commitment Push Model requests for SOP Instances of any of
                  the Storage SOP Classes that are also supported by the
                  dcm4che Storage Server AE::</para>

                  <table>
                    <title>Supported Referenced SOP Classes In Storage
                    Commitment Push Model N-ACTION Requests</title>

                    <tgroup align="left" cols="1">
                      <colspec align="left" colname="c1" />

                      <thead>
                        <row>
                          <entry>Supported Referenced SOP Classes</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Hardcopy Grayscale Image Storage SOP
                          Class</entry>
                        </row>

                        <row>
                          <entry>Hardcopy Color Image Storage SOP
                          Class</entry>
                        </row>

                        <row>
                          <entry>Computed Radiography Image Storage</entry>
                        </row>

                        <row>
                          <entry>Digital X-Ray Image Storage - For
                          Presentation</entry>
                        </row>

                        <row>
                          <entry>Digital X-Ray Image Storage - For
                          Processing</entry>
                        </row>

                        <row>
                          <entry>Digital Mammography X-Ray Image Storage - For
                          Presentation</entry>
                        </row>

                        <row>
                          <entry>Digital Mammography X-Ray Image Storage - For
                          Processing</entry>
                        </row>

                        <row>
                          <entry>Digital Intra-oral X-Ray Image Storage - For
                          Presentation</entry>
                        </row>

                        <row>
                          <entry>Digital Intra-oral X-Ray Image Storage - For
                          Processing</entry>
                        </row>

                        <row>
                          <entry>CT Image Storage</entry>
                        </row>

                        <row>
                          <entry>Ultrasound Multi-frame Image Storage</entry>
                        </row>

                        <row>
                          <entry>MR Image Storage</entry>
                        </row>

                        <row>
                          <entry>Enhanced MR Image Storage</entry>
                        </row>

                        <row>
                          <entry>Ultrasound Image Storage</entry>
                        </row>

                        <row>
                          <entry>Secondary Capture Image Storage</entry>
                        </row>

                        <row>
                          <entry>X-Ray Angiographic Image Storage</entry>
                        </row>

                        <row>
                          <entry>X-Ray Radiofluoroscopic Image Storage</entry>
                        </row>

                        <row>
                          <entry>Nuclear Medicine Image Storage</entry>
                        </row>

                        <row>
                          <entry>VL Endoscopic Image Storage</entry>
                        </row>

                        <row>
                          <entry>VL Microscopic Image Storage</entry>
                        </row>

                        <row>
                          <entry>VL Slide-Coordinates Microscopic Image
                          Storage</entry>
                        </row>

                        <row>
                          <entry>VL Photographic Image Storage</entry>
                        </row>

                        <row>
                          <entry>Positron Emission Tomography Image
                          Storage</entry>
                        </row>

                        <row>
                          <entry>RT Image Storage</entry>
                        </row>

                        <row>
                          <entry>Grayscale Softcopy Presentation State Storage
                          SOP Class</entry>
                        </row>

                        <row>
                          <entry>Basic Text SR</entry>
                        </row>

                        <row>
                          <entry>Enhanced SR</entry>
                        </row>

                        <row>
                          <entry>Comprehensive SR</entry>
                        </row>

                        <row>
                          <entry>Key Object Selection Document</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table>

                  <para>The dcm4che/archive Storage Server AE will return the
                  following Status Code values in N-ACTION Responses:</para>

                  <table>
                    <title>dcm4che/archive Storage Server N-ACTION Response
                    Status</title>

                    <tgroup align="left" cols="4">
                      <colspec colwidth="40" />

                      <colspec colwidth="80" />

                      <colspec colwidth="40" />

                      <thead>
                        <row valign="middle">
                          <entry>Service Status</entry>

                          <entry>Further Meaning</entry>

                          <entry>Error Code</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Success</entry>

                          <entry>Success</entry>

                          <entry>0000</entry>

                          <entry>The SCP has successfully received the Storage
                          Commitment Push Model N-ACTION Request and can
                          process the commitment request for the indicated SOP
                          Instances.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Processing Failure</entry>

                          <entry>0110</entry>

                          <entry>Indicates that the Storage Commitment Push
                          Model N-ACTION Request cannot be parsed or fully
                          processed due to a database or system
                          failure.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Missing Attribute</entry>

                          <entry>0120</entry>

                          <entry>Indicates that the Storage Commitment Push
                          Model N-ACTION Request cannot be processed because a
                          required attribute is missing from the N-ACTION
                          Request Data Set.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Missing Attribute Value</entry>

                          <entry>0121</entry>

                          <entry>Indicates that the Storage Commitment Push
                          Model N-ACTION Request cannot be processed because a
                          Type 1 attribute in the N-ACTION Request Data Set
                          does not specify a value.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table>

                  <para>The dcm4che Storage Server AE will exhibit the
                  following Behavior according to the Status Code value
                  returned in an N-EVENT-REPORT Response from a destination
                  Storage Commitment Push Model SCU:</para>

                  <table>
                    <title>dcm4che/archive Storage Server N-EVENT Report
                    Response Status Handling Behaviour</title>

                    <tgroup align="left" cols="4">
                      <colspec colwidth="40" />

                      <colspec colwidth="80" />

                      <colspec colwidth="40" />

                      <thead>
                        <row valign="middle">
                          <entry>Service Status</entry>

                          <entry>Further Meaning</entry>

                          <entry>Error Code</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Success</entry>

                          <entry>Success</entry>

                          <entry>0000</entry>

                          <entry>The SCU has successfully received the Storage
                          Commitment Push Model N-EVENT-REPORT Request.
                          Success indication message is output to the Service
                          Logs.</entry>
                        </row>

                        <row>
                          <entry>Warning</entry>

                          <entry>Attribute List Error</entry>

                          <entry>0107</entry>

                          <entry>Transmission of Storage Commitment Push Model
                          N-EVENTREPORT Request is considered successful.
                          Warning indication message is output to the Service
                          Logs.</entry>
                        </row>

                        <row>
                          <entry>*</entry>

                          <entry>*</entry>

                          <entry>Any Other Code</entry>

                          <entry>This is treated as a permanent Failure. Error
                          indication message is output to the Service
                          Logs.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table>

                  <para>The next table report the dcm4che Storage Server
                  behaviour in case of communication failure:</para>

                  <table>
                    <title>dcm4che/archive Storage Server AE Storage
                    Commitment Push Model Communication Failure
                    Behaviour</title>

                    <tgroup align="left" cols="2">
                      <colspec colwidth="50%" />

                      <thead>
                        <row valign="middle">
                          <entry>Exception</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Timeout expiry for an expected DICOM Message
                          Request (DIMSE level timeout). I.e. The STORAGE-SCP
                          AE is waiting for the next N-ACTION Request on an
                          open Association but the timer expires.</entry>

                          <entry>The Association is aborted by issuing a DICOM
                          A-ABORT. If some Composite SOP Instances have been
                          successfully received over the same Association via
                          the Storage Service then they are maintained in the
                          database. They are not automatically discarded
                          because of a later Storage Commitment messaging
                          failure. Any previously received Storage Commitment
                          Push Model NACTION Requests will still be fully
                          processed. Error indication message is output to the
                          Service Logs. No message is posted to the User
                          Interface.</entry>
                        </row>

                        <row>
                          <entry>Timeout expiry for an expected DICOM PDU or
                          TCP/IP packet (Low-level timeout).</entry>

                          <entry>The Association is aborted by issuing a DICOM
                          A-ABORT. If some Composite SOP Instances have been
                          successfully received over the same Association via
                          the Storage Service then they are maintained in the
                          database. They are not automatically discarded
                          because of a later Storage Commitment messaging
                          failure. Any previously received Storage Commitment
                          Push Model NACTION Requests will still be fully
                          processed. Error indication message is output to the
                          Service Logs. No message is posted to the User
                          Interface.</entry>
                        </row>

                        <row>
                          <entry>Association A-ABORTed by the SCU or the
                          network layers indicate communication loss (i.e.
                          low-level TCP/IP socket closure).</entry>

                          <entry>The TCP/IP socket is closed. If some
                          Composite SOP Instances have been successfully
                          received over the same Association via the Storage
                          Service then they are maintained in the database.
                          They are not automatically discarded because of a
                          later Storage Commitment messaging failure. Any
                          previously received Storage Commitment Push Model
                          NACTION Requests will still be fully processed.
                          Error indication message is output to the Service
                          Logs. No message is posted to the User
                          Interface.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table>
                </section>
              </section>
            </section>
          </section>
        </section>
      </section>

      <section>
        <title>dcm4che/archive Query/Retrieve Server Application Entity
        Specification</title>

        <section>
          <title>SOP Classes</title>

          <para>dcm4che/archive Query/Retrieve Server Application Entity
          provides Standard Conformance to the following SOP Classes:<table>
              <title>SOP Classes for dcm4che/archive Query/Retrieve Server
              AE</title>

              <tgroup align="left" cols="4">
                <colspec align="left" colname="c1" />

                <colspec align="left" colname="c2" colwidth="120" />

                <colspec align="center" colname="c3" colwidth="25" />

                <colspec align="center" colname="c4" colwidth="25" />

                <thead>
                  <row>
                    <entry>SOP Class Name</entry>

                    <entry>SOP Class UID</entry>

                    <entry>SCU</entry>

                    <entry>SCP</entry>
                  </row>
                </thead>

                <tbody>
                  <row>
                    <entry>Verification SOP Class</entry>

                    <entry>1.2.840.10008.1.1</entry>

                    <entry>Yes</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Patient Root Q/R Information Model - FIND</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.1.1</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Patient Root Q/R Information Model - MOVE</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.1.2</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Study Root Q/R Information Model - FIND</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.2.1</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Study Root Q/R Information Model - MOVE</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.2.2</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Patient/Study Only Q/R Information Model -
                    FIND</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.3.1</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Patient/Study Only Q/R Information Model -
                    MOVE</entry>

                    <entry>1.2.840.10008.5.1.4.1.2.3.2</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Hardcopy Grayscale Image Storage SOP Class</entry>

                    <entry>1.2.840.10008.5.1.1.29</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Hardcopy Color Image Storage SOP Class</entry>

                    <entry>1.2.840.10008.5.1.1.30</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Computed Radiography Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital X-Ray Image Storage - For
                    Presentation</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital X-Ray Image Storage - For
                    Processing</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.1.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital Mammography X-Ray Image Storage - For
                    Presentation</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.2</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital Mammography X-Ray Image Storage - For
                    Processing</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.2.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital Intra-oral X-Ray Image Storage - For
                    Presentation</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.3</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Digital Intra-oral X-Ray Image Storage - For
                    Processing</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.1.3.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>CT Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.2</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Ultrasound Multi-frame Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.3.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>MR Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.4</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Enhanced MR Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.4.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Ultrasound Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.6.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Secondary Capture Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.7</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Multi-frame Grayscale Byte Secondary Capture Image
                    Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.7.2</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Multi-frame Grayscale Word Secondary Capture Image
                    Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.7.3</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Multi-frame Color Secondary Capture Image
                    Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.7.4</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>X-Ray Angiographic Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.12.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>X-Ray Radiofluoroscopic Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.12.2</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Nuclear Medicine Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.20</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Raw Data Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.66</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>VL Endoscopic Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.77.1.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>VL Microscopic Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.77.1.2</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>VL Slide-Coordinates Microscopic Image
                    Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.77.1.3</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>VL Photographic Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.77.1.4</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Positron Emission Tomography Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.128</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>RT Image Storage</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.481.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Grayscale Softcopy Presentation State Storage SOP
                    Class</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.11.1</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Basic Text SR</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.88.11</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Enhanced SR</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.88.22</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Comprehensive SR</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.88.33</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>

                  <row>
                    <entry>Key Object Selection Document</entry>

                    <entry>1.2.840.10008.5.1.4.1.1.88.59</entry>

                    <entry>Yes</entry>

                    <entry>No</entry>
                  </row>
                </tbody>
              </tgroup>
            </table></para>
        </section>

        <section>
          <title>Association Establishment Policy</title>

          <section>
            <title>General</title>

            <para>The dcm4che/archive Query/Retrieve Server AE can both accept
            and propose Association Requests. The Query/Retrieve Server AE
            will accept Association Requests for the Verification and
            Query/Retrieve Services. It will propose Associations for
            Verification and Storage Services.</para>

            <para>The DICOM standard application context name for DICOM 3.0 is
            always accepted and proposed:</para>

            <para><table>
                <title>DICOM application context name for dcm4che
                Query/Retrieve Server AE</title>

                <tgroup align="left" cols="2">
                  <tbody>
                    <row>
                      <entry>Application Context Name</entry>

                      <entry>1.2.840.10008.3.1.1.1</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>
          </section>

          <section>
            <title>Number of Associations</title>

            <para>dcm4che/archive Query/Retrieve Server can support multiple
            simultaneous Associations requested by peer AEs. Default is 10.
            This value can be configured through the attribute "MaxClients" in
            the Application Server configuration file (i.e. jboss-service.xml
            for JBoss application seerver).</para>

            <table>
              <title>Number of Associations accepted for dcm4che
              Query/Retrieve Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of simultaneous Associations</entry>

                    <entry>10 (Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Asynchronous Nature</title>

            <para>dcm4che/archive Query/Retrieve Server does not support
            asynchronous communication. Multiple outstanding transactions are
            not supported. It allows up to one invoked and one performed
            operation on an Association (it is synchronous). Asynchronous mode
            of operation is not supported.</para>

            <table>
              <title>Asynchronous Nature as SCP for dcm4che Query/Retrieve
              Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of outstanding asynchronous
                    transactions</entry>

                    <entry>1 (Not Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Implementation Identifying Information</title>

            <para>The implementation information for this Application Entity
            is:</para>

            <table>
              <title>DICOM Implementation Class and Version for dcm4che
              Query/Retrieve Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Implementation Class UID</entry>

                    <entry>1.2.40.0.13.1.1</entry>
                  </row>

                  <row>
                    <entry>Implementation Version Name</entry>

                    <entry>dcm4che-1.1</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>
        </section>

        <section>
          <title>Association Initiation Policy</title>

          <section>
            <title>Activity - Send Images Requested by an External Peer
            AE</title>

            <section>
              <title>Description and Sequencing of Activities</title>

              <para>The dcm4che/archive Query/Retrieve Server AE will initiate
              a new Association when a valid C-MOVE Request has been performed
              by an external Peer. The Query/Retrieve Server AE will send the
              Association Request to the specific C-MOVE destination, and upon
              successful negotiation of the required Presentation Context the
              image transfer is started. In all cases an attempt will be made
              to transmit all the indicated images in a single Association but
              this may not always be possible. The Association will be
              released when all the images have been sent.</para>

              <para>If an error occurs during transmission over an open
              Association then the image transfer is halted. The
              Query/Retrieve Server AE will not attempt to independently retry
              the image export.</para>

              <section>
                <title>Proposed Presentation Contexts</title>

                <para>dcm4che/archive Query/Retrieve Server will propose
                Presentation Contexts as shown in the following table:<table>
                    <title>Proposed Presentation Contexts by the
                    dcm4che/archive Query/Retrieve Server AE</title>

                    <tgroup align="left" cols="6">
                      <colspec colname="c1" />

                      <colspec colname="c2" colwidth="110" />

                      <colspec colname="c3" colwidth="60" />

                      <colspec colname="c4" colwidth="90" />

                      <colspec align="center" colname="c5" colwidth="30" />

                      <colspec align="center" colname="c6" colwidth="30" />

                      <spanspec align="center" nameend="c2" namest="c1"
                                spanname="s12" />

                      <spanspec align="center" nameend="c4" namest="c3"
                                spanname="s34" />

                      <thead>
                        <row valign="middle">
                          <entry spanname="s12">Abstract Syntax</entry>

                          <entry spanname="s34">Transfer Syntax</entry>

                          <entry morerows="1">Role</entry>

                          <entry morerows="1">Ext. Neg.</entry>
                        </row>

                        <row>
                          <entry>Name</entry>

                          <entry>UID</entry>

                          <entry>Name List</entry>

                          <entry>UID List</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Hardcopy Grayscale Image Storage SOP
                          Class</entry>

                          <entry>1.2.840.10008.5.1.1.29</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Hardcopy Color Image Storage SOP
                          Class</entry>

                          <entry>1.2.840.10008.5.1.1.30</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Computed Radiography Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital X-Ray Image Storage - For
                          Presentation</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital X-Ray Image Storage - For
                          Processing</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.1.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital Mammography X-Ray Image Storage - For
                          Presentation</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.2</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital Mammography X-Ray Image Storage - For
                          Processing</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.2.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital Intra-oral X-Ray Image Storage - For
                          Presentation</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.3</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Digital Intra-oral X-Ray Image Storage - For
                          Processing</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.1.3.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>CT Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.2</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Ultrasound Multi-frame Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.3.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>MR Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.4</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Enhanced MR Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.4.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Ultrasound Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.6.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Secondary Capture Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.7</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>X-Ray Angiographic Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.12.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>X-Ray Radiofluoroscopic Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.12.2</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Nuclear Medicine Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.20</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>VL Endoscopic Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.77.1.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>VL Microscopic Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.77.1.2</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>VL Slide-Coordinates Microscopic Image
                          Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.77.1.3</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>VL Photographic Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.77.1.4</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Positron Emission Tomography Image
                          Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.128</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>RT Image Storage</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.481.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsimage">Transfer Syntaxes for
                          Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Grayscale Softcopy Presentation State Storage
                          SOP Class</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.11.1</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsnoimage">Transfer Syntaxes for
                          Non-Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Basic Text SR</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.88.11</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsnoimage">Transfer Syntaxes for
                          Non-Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Enhanced SR</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.88.22</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsnoimage">Transfer Syntaxes for
                          Non-Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Comprehensive SR</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.88.33</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsnoimage">Transfer Syntaxes for
                          Non-Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>

                        <row>
                          <entry>Key Object Selection Document</entry>

                          <entry>1.2.840.10008.5.1.4.1.1.88.59</entry>

                          <entry spanname="s34"><link
                          linkend="t-proposed-tsnoimage">Transfer Syntaxes for
                          Non-Image Storage Services</link></entry>

                          <entry>SCU</entry>

                          <entry>None</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table><table id="t-proposed-tsnoimage">
                    <title>Proposed Transfer Syntaxes for Non-Image Storage
                    Services</title>

                    <tgroup cols="2">
                      <colspec colwidth="200" />

                      <colspec colwidth="120" />

                      <thead>
                        <row>
                          <entry>Name</entry>

                          <entry>UID</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Implicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2</entry>
                        </row>

                        <row>
                          <entry>Explicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2.1</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table><table id="t-proposed-tsimage">
                    <title>Proposed Transfer Syntaxes for Image Storage
                    Services</title>

                    <tgroup cols="2">
                      <colspec colwidth="200" />

                      <colspec colwidth="120" />

                      <thead>
                        <row>
                          <entry>Name</entry>

                          <entry>UID</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Implicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2</entry>
                        </row>

                        <row>
                          <entry>Explicit VR Little Endian</entry>

                          <entry>1.2.840.10008.1.2.1</entry>
                        </row>

                        <row>
                          <entry>JPEG Baseline</entry>

                          <entry>1.2.840.10008.1.2.4.50</entry>
                        </row>

                        <row>
                          <entry>JPEG Extended</entry>

                          <entry>1.2.840.10008.1.2.4.51</entry>
                        </row>

                        <row>
                          <entry>JPEG Lossless, Non-Hierarchical</entry>

                          <entry>1.2.840.10008.1.2.4.57</entry>
                        </row>

                        <row>
                          <entry>JPEG Lossless, Non-Hierarchical, First-Order
                          Prediction</entry>

                          <entry>1.2.840.10008.1.2.4.70</entry>
                        </row>

                        <row>
                          <entry>JPEG-LS Lossless Image Compression</entry>

                          <entry>1.2.840.10008.1.2.4.80</entry>
                        </row>

                        <row>
                          <entry>JPEG-LS Lossy (Near-Lossless) Image</entry>

                          <entry>1.2.840.10008.1.2.4.81</entry>
                        </row>

                        <row>
                          <entry>JPEG 2000 Image Compression (Lossless
                          Only)</entry>

                          <entry>1.2.840.10008.1.2.4.90</entry>
                        </row>

                        <row>
                          <entry>JPEG 2000 Image Compression</entry>

                          <entry>1.2.840.10008.1.2.4.91</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table></para>

                <section>
                  <title>SOP Specific Conformance</title>

                  <section>
                    <title>Specific Conformance for Image, SR, KIN and SPS SOP
                    Classes</title>

                    <para>When a SOP Instance is selected for export from
                    dcm4che/archive Query/Retrieve Server, its contents will
                    be exported as it was originally received unless some of
                    the Patient demographic and Study information Elements
                    were altered.</para>

                    <para>The Patient demographic and Study information can be
                    entered or altered by several means: manually (through the
                    web interface), or from HL7 messaging. The replacement
                    behavior depends on which specific DICOM and HL7 services
                    are supported. Also, this behavior is configurable. Values
                    can be altered without changing the SOP Instance UID
                    unless otherwise noted.</para>

                    <para>The Query/Retrieve Server AE will exhibit the
                    following behavior according to the Status Code value
                    returned in a C-STORE Response from a destination C-STORE
                    SCP:</para>

                    <para><table>
                        <title>dcm4che/archive Query/Retrieve Server AE
                        C-STORE Response Status Handling Behavior</title>

                        <tgroup align="left" cols="4">
                          <colspec colwidth="40" />

                          <colspec colwidth="80" />

                          <colspec colwidth="40" />

                          <thead>
                            <row valign="middle">
                              <entry>Service Status</entry>

                              <entry>Further Meaning</entry>

                              <entry>Error Code</entry>

                              <entry>Behavior</entry>
                            </row>
                          </thead>

                          <tbody>
                            <row>
                              <entry>Success</entry>

                              <entry>Success</entry>

                              <entry>0000</entry>

                              <entry>The remote Storage SCP has successfully
                              stored the exported SOPInstance. The appropriate
                              PENDING or SUCCESS Status will be sent in the C-MOVE
                              Response. Success indication message is output to
                              the Service Log.</entry>
                            </row>

                            <row>
                              <entry>Refused</entry>

                              <entry>Out of Resources</entry>

                              <entry>A700-A7FF</entry>

                              <entry>This is treated as a permanent Failure. The
                              appropriate Status will be sent in the C-MOVE
                              Response. Error indication message is output to the
                              Service Log.</entry>
                            </row>

                            <row>
                              <entry>Error</entry>

                              <entry>Cannot Understand</entry>

                              <entry>C000-CFFF</entry>

                              <entry>This is treated as a permanent Failure. The
                              appropriate Status will be sent in the C-MOVE
                              Response. Error indication message is output to the
                              Service Log.</entry>
                            </row>

                            <row>
                              <entry>Warning</entry>

                              <entry>Coercion of Data Elements</entry>

                              <entry>B000</entry>

                              <entry>Image transmission is considered successful.
                              The appropriate PENDING or SUCCESS Status will be
                              sent in the C-MOVE Response. Success indication
                              message is output to the Service Log.</entry>
                            </row>

                            <row>
                              <entry>Warning</entry>

                              <entry>Data Set does not match SOP class</entry>

                              <entry>B007</entry>

                              <entry>Image transmission is considered successful.
                              The appropriate PENDING or SUCCESS Status will be
                              sent in the C-MOVE Response. Success indication
                              message is output to the Service Log.</entry>
                            </row>

                            <row>
                              <entry>Warning</entry>

                              <entry>Elements Discarded</entry>

                              <entry>B006</entry>

                              <entry>Image transmission is considered successful.
                              The appropriate PENDING or SUCCESS Status will be
                              sent in the C-MOVE Response. Success indication
                              message is output to the Service Log.</entry>
                            </row>

                            <row>
                              <entry>Warning</entry>

                              <entry>Attribute List Error</entry>

                              <entry>0107</entry>

                              <entry>Image transmission is considered successful.
                              The appropriate PENDING or SUCCESS Status will be
                              sent in the C-MOVE Response. Success indication
                              message is output to the Service Log.</entry>
                            </row>

                            <row>
                              <entry>Warning</entry>

                              <entry>Attribute Value Out of Range</entry>

                              <entry>0116</entry>

                              <entry>Image transmission is considered successful.
                              The appropriate PENDING or SUCCESS Status will be
                              sent in the C-MOVE Response. Success indication
                              message is output to the Service Log.</entry>
                            </row>

                            <row>
                              <entry>*</entry>

                              <entry>*</entry>

                              <entry>Any other status code</entry>

                              <entry>This is treated as a permanent Failure. The
                              appropriate Status will be sent in the C-MOVE
                              Response. Error indication message is output to the
                              Service Log.</entry>
                            </row>
                          </tbody>
                        </tgroup>
                      </table></para>

                    <para><table>
                        <title>dcm4che/archive Query/Retrieve Server AE
                        Communication Failure Behavior</title>

                        <tgroup align="left" cols="2">
                          <colspec colwidth="50%" />

                          <thead>
                            <row valign="middle">
                              <entry>Exception</entry>

                              <entry>Behavior</entry>
                            </row>
                          </thead>

                          <tbody>
                            <row>
                              <entry>Timeout expiry for an expected DICOM Message
                              Request (DIMSE level timeout).</entry>

                              <entry>The Association is aborted by issuing a DICOM
                              A-ABORT. The appropriate Status will be sent in the
                              CMOVE Response. Error indication message is output
                              to the Service Logs</entry>
                            </row>

                            <row>
                              <entry>Timeout expiry for an expected DICOM PDU or
                              TCP/IP packet (Low-level timeout).</entry>

                              <entry>The Association is aborted by issuing a DICOM
                              A-ABORT. The appropriate Status will be sent in the
                              CMOVE Response. Error indication message is output
                              to the Service Logs</entry>
                            </row>

                            <row>
                              <entry>Association A-ABORTed by the SCU or the
                              network layers indicate communication loss (i.e.
                              low-level TCP/IP socket closure).</entry>

                              <entry>The TCP/IP Socket is closed. Error indication
                              message is output to the Service Logs.</entry>
                            </row>
                          </tbody>
                        </tgroup>
                      </table></para>
                  </section>
                </section>
              </section>
            </section>
          </section>
        </section>

        <section>
          <title>Association Acceptance Policy</title>

          <section>
            <title>Activity - Handling Query and Retrieval Requests</title>

            <section>
              <title>Description and Sequencing of Activities</title>

              <para>The Query/Retrieve Server AE accepts Associations only if
              they have valid Presentation Contexts. If none of the requested
              Presentation Contexts are accepted then the Association Request
              itself is rejected. It can be configured to only accept
              Associations from certain Application Entities.</para>

              <para>If Query/Retrieve Server AE receives a query (C-FIND)
              request then the response(s) will be sent over the same
              Association used to send the C-FIND-Request.</para>

              <para>If Query/Retrieve Server AE receives a retrieval (C-MOVE)
              request then the responses will be sent over the same
              Association used to send the C-MOVE-Request.</para>

              <para>The Query/Retrieve Server AE will send the requested SOP
              Instances to the C-MOVE Destination over a newly created
              Association and report in the C-MOVE-Response any success or
              failure status of each attempt to send a CompositeSOP
              Instance.</para>

              <para>When an association has been established the Sequencing of
              Real-World Activities is as described in <xref
              linkend="s-sequencing" />.</para>

              <para>The Query/Retrieve Server AE may reject Association
              attempts as shown in the table below. The Result, Source and
              Reason / Diag columns represent the values returned in the
              corresponding fields of an ASSOCIATE-RJ PDU (see PS 3.8, Section
              9.3.4).</para>

              <table>
                <title>Association Rejection Reasons</title>

                <tgroup align="left" cols="4">
                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <thead>
                    <row>
                      <entry>Result</entry>

                      <entry>Source</entry>

                      <entry>Reason</entry>

                      <entry>Description</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>2 - rejected transient</entry>

                      <entry>provider</entry>

                      <entry>2 - local-limit exceeded</entry>

                      <entry>The (configurable) maximum number of simultaneous
                      associations has been reached. An association request
                      with the same parameters may succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>2 - application context name not
                      supported</entry>

                      <entry>The Association request contained an unsupported
                      Application Context Name. An association request with
                      the same parameters will NOT succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>3 – calling AE title not recognized</entry>

                      <entry>The Association request contained an unrecognized
                      Calling AE Title. An association request with the same
                      parameters will NOT succeed at a later time unless
                      configuration changes are made.</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>
            </section>

            <section>
              <title>Accepted Presentation Contexts</title>

              <table>
                <title>Accepted Presentation Contexts for dcm4che/archive
                Query/Retrieve Server AE</title>

                <tgroup align="left" cols="6">
                  <colspec colname="c1" />

                  <colspec colname="c2" colwidth="110" />

                  <colspec colname="c3" colwidth="60" />

                  <colspec colname="c4" colwidth="90" />

                  <colspec align="center" colname="c5" colwidth="30" />

                  <colspec align="center" colname="c6" colwidth="30" />

                  <spanspec align="center" nameend="c2" namest="c1"
                            spanname="s12" />

                  <spanspec align="center" nameend="c4" namest="c3"
                            spanname="s34" />

                  <thead>
                    <row valign="middle">
                      <entry spanname="s12">Abstract Syntax</entry>

                      <entry spanname="s34">Transfer Syntax</entry>

                      <entry morerows="1">Role</entry>

                      <entry morerows="1">Ext. Neg.</entry>
                    </row>

                    <row>
                      <entry>Name</entry>

                      <entry>UID</entry>

                      <entry>Name List</entry>

                      <entry>UID List</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Verification SOP Class</entry>

                      <entry>1.2.840.10008.1.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry morerows="1">Patient Root Q/R Information Model –
                      FIND</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.1.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-queries</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry morerows="1">Patient Root Q/R Information Model –
                      MOVE</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.1.2</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-retrieve</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry morerows="1">Study Root Q/R Information Model –
                      FIND</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.2.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-queries</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry morerows="1">Study Root Q/R Information Model –
                      MOVE</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.2.2</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-retrieve</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry morerows="1">Patient/Study Only Q/R Information
                      Model – FIND</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.3.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-queries</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>

                    <row>
                      <entry morerows="1">Patient/Study Only Q/R Information
                      Model – MOVE</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.1.2.3.2</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">Relational-retrieve</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>

              <para>If the Called AET is not corresponding to the actual
              Storage Server AET, it only will be accepted the Presentation
              Context for the Verification SOP Class.</para>
            </section>

            <section>
              <title>SOP Specific Conformance</title>

              <section>
                <title>Specific Conformance for Verification SOP Class</title>

                <para>dcm4che/archive Storage Server provides standard
                conformance to the DICOM Verification Service Class as a SCP.
                The status code for the C-ECHO is described in the following
                table:</para>

                <table>
                  <title>C-Echo Response Status Handling Behavior</title>

                  <tgroup align="left" cols="4">
                    <colspec colwidth="40" />

                    <colspec colwidth="100" />

                    <colspec colwidth="40" />

                    <thead>
                      <row valign="middle">
                        <entry>Service Status</entry>

                        <entry>Further Meaning</entry>

                        <entry>Error Code</entry>

                        <entry>Behavior</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry>Success</entry>

                        <entry>Success</entry>

                        <entry>0000</entry>

                        <entry>The C-ECHO request is accepted</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table>
              </section>

              <section>
                <title>Specific Conformance for Query SOP Classes</title>

                <para>The Query/Retrieve Server AE supports hierarchical and
                relational queries. There are no attributes always returned by
                default. Only those attributes requested in the query
                identifier are returned.</para>

                <para>Query responses always return values from the
                Query/Retrieve Server database. Exported SOP Instances are
                always updated with the latest values kept in the database
                prior to export. Thus, a change in Patient demographic
                information will be contained in both the C-FIND Responses and
                any Composite SOP Instances exported to a C-MOVE Destination
                AE.</para>

                <para>Patient Root Information Model: All required search keys
                on each of the four levels (Patient, Study, Series, and Image)
                are supported. However, the Patient ID (0010,0020) key must
                have at least a partial value if the Patient’s Name
                (0010,0010) is not present in a Patient Level query.</para>

                <para>Study Root Information Model: All the required search
                keys on each of the three levels (Study, Series, and Image)
                are supported. If no partial values are specified for Study
                attributes then either the Patient ID (0010,0020) key or the
                Patient’s Name (0010,0010) must have at least a partial value
                specified.</para>

                <para>Patient/Study Only Information Model: All the required
                search keys on the Patient and Study levels are supported. The
                Patient ID (0010,0020) key must be at least partially stated
                if the Patient’s Name (0010,0010) is not present in a Patient
                Level query.</para>

                <table>
                  <title>Patient Root C-FIND SCP Supported Elements</title>

                  <tgroup align="left" cols="4">
                    <colspec colname="c1" colwidth="200" />

                    <colspec align="left" colname="c2" colwidth="60" />

                    <colspec align="left" colname="c3" colwidth="40" />

                    <colspec colname="c4" />

                    <spanspec nameend="c4" namest="c1" spanname="c1-4" />

                    <thead>
                      <row valign="middle">
                        <entry>Attribute Name</entry>

                        <entry>Tag</entry>

                        <entry>VR</entry>

                        <entry>Types of Matching</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry spanname="c1-4"><emphasis>SOP
                        Common</emphasis></entry>
                      </row>

                      <row>
                        <entry>Specific Character Set</entry>

                        <entry>0008,0005</entry>

                        <entry>CS</entry>

                        <entry>NONE</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Patient
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>Patient's Name</entry>

                        <entry>0010,0010</entry>

                        <entry>PN</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Patient ID</entry>

                        <entry>0010,0020</entry>

                        <entry>LO</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Issuer of Patient ID</entry>

                        <entry>0010,0021</entry>

                        <entry>LO</entry>

                        <entry>NONE</entry>
                      </row>

                      <row>
                        <entry>Patient's Birth Date</entry>

                        <entry>0010,0030</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Patient's Sex</entry>

                        <entry>0010,0040</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Study
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>Study Instance UID</entry>

                        <entry>0020,000D</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Study ID</entry>

                        <entry>0020,0010</entry>

                        <entry>SH</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Study Date</entry>

                        <entry>0008,0020</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Study Time</entry>

                        <entry>0008,0030</entry>

                        <entry>TM</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Accession Number</entry>

                        <entry>0008,0050</entry>

                        <entry>SH</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Referring Physician's Name</entry>

                        <entry>0008,0090</entry>

                        <entry>PN</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Modalities In Study</entry>

                        <entry>0008,0061</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Series
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>Series Instance UID</entry>

                        <entry>0020,000E</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Series Number</entry>

                        <entry>0020,0011</entry>

                        <entry>IS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Modality</entry>

                        <entry>0008,0060</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Performed Procedure Step Start Date</entry>

                        <entry>0040,0244</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Performed Procedure Step Start Time</entry>

                        <entry>0040,0245</entry>

                        <entry>TM</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Image
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>SOP Instance UID</entry>

                        <entry>0008,0018</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>SOP Class UID</entry>

                        <entry>0008,0016</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Instance Number</entry>

                        <entry>0020,0013</entry>

                        <entry>IS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Completion Flag</entry>

                        <entry>0040,0A91</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Verfication Flag</entry>

                        <entry>0040,0A93</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table>

                <table>
                  <title>Study Root C-FIND SCP Supported Elements</title>

                  <tgroup align="left" cols="4">
                    <colspec colname="c1" colwidth="200" />

                    <colspec align="left" colname="c2" colwidth="60" />

                    <colspec align="left" colname="c3" colwidth="40" />

                    <colspec colname="c4" />

                    <spanspec nameend="c4" namest="c1" spanname="c1-4" />

                    <thead>
                      <row valign="middle">
                        <entry>Attribute Name</entry>

                        <entry>Tag</entry>

                        <entry>VR</entry>

                        <entry>Types of Matching</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry spanname="c1-4"><emphasis>SOP
                        Common</emphasis></entry>
                      </row>

                      <row>
                        <entry>Specific Character Set</entry>

                        <entry>0008,0005</entry>

                        <entry>CS</entry>

                        <entry>NONE</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Study
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>Patient's Name</entry>

                        <entry>0010,0010</entry>

                        <entry>PN</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Patient ID</entry>

                        <entry>0010,0020</entry>

                        <entry>LO</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Issuer of Patient ID</entry>

                        <entry>0010,0021</entry>

                        <entry>LO</entry>

                        <entry>NONE</entry>
                      </row>

                      <row>
                        <entry>Patient's Birth Date</entry>

                        <entry>0010,0030</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Patient's Sex</entry>

                        <entry>0010,0040</entry>

                        <entry>CS</entry>

                        <entry>S,U</entry>
                      </row>

                      <row>
                        <entry>Study Instance UID</entry>

                        <entry>0020,000D</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Study ID</entry>

                        <entry>0020,0010</entry>

                        <entry>SH</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Study Date</entry>

                        <entry>0008,0020</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Study Time</entry>

                        <entry>0008,0030</entry>

                        <entry>TM</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Accession Number</entry>

                        <entry>0008,0050</entry>

                        <entry>SH</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Referring Physician's Name</entry>

                        <entry>0008,0090</entry>

                        <entry>PN</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Modalities In Study</entry>

                        <entry>0008,0061</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Series
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>Series Instance UID</entry>

                        <entry>0020,000E</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Series Number</entry>

                        <entry>0020,0011</entry>

                        <entry>IS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Modality</entry>

                        <entry>0008,0060</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Performed Procedure Step Start Date</entry>

                        <entry>0040,0244</entry>

                        <entry>DA</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry>Performed Procedure Step Start Time</entry>

                        <entry>0040,0245</entry>

                        <entry>TM</entry>

                        <entry>S,U,R</entry>
                      </row>

                      <row>
                        <entry spanname="c1-4"><emphasis>Image
                        Level</emphasis></entry>
                      </row>

                      <row>
                        <entry>SOP Instance UID</entry>

                        <entry>0008,0018</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>SOP Class UID</entry>

                        <entry>0008,0016</entry>

                        <entry>UI</entry>

                        <entry>S,L</entry>
                      </row>

                      <row>
                        <entry>Instance Number</entry>

                        <entry>0020,0013</entry>

                        <entry>IS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Completion Flag</entry>

                        <entry>0040,0A91</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>

                      <row>
                        <entry>Verfication Flag</entry>

                        <entry>0040,0A93</entry>

                        <entry>CS</entry>

                        <entry>S,*,U</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table>

                <para>Types of Matching:</para>

                <para>The types of Matching supported by the C-FIND SCP. An
                "S" indicates the identifier attribute uses Single Value
                Matching, an “R” indicates Range Matching, an “*” indicates
                wildcard matching, a ‘U’ indicates Universal Matching, and an
                ‘L’ indicates that UID lists are supported for matching.
                “NONE” indicates that no matching is supported, but that
                values for this Element are requested to be returned (i.e.
                universal matching).<table>
                    <title>dcm4che/archive Query/Retrieve Server C-FIND
                    Response Status</title>

                    <tgroup align="left" cols="4">
                      <colspec colwidth="40" />

                      <colspec colwidth="80" />

                      <colspec colwidth="40" />

                      <thead>
                        <row valign="middle">
                          <entry>Service Status</entry>

                          <entry>Further Meaning</entry>

                          <entry>Error Code</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Success</entry>

                          <entry>Success</entry>

                          <entry>0000</entry>

                          <entry>Matching is complete. No final identifier is
                          supplied</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Processing Failure</entry>

                          <entry>0110</entry>

                          <entry>This status is returned due to internal
                          errors such as a processing failure response on an
                          query of the internal database. The appropriate
                          Status will be sent in the C-FIND Response. Error
                          indication message is output to the Service
                          Log.</entry>
                        </row>

                        <row>
                          <entry>Cancel</entry>

                          <entry>Matching terminated due to Cancel
                          Request</entry>

                          <entry>FE00</entry>

                          <entry>The C-FIND SCU sent a Cancel Request. This
                          has been acknowledged and the search for matches has
                          been halted. Cancel indication message is output to
                          the Service Log.</entry>
                        </row>

                        <row>
                          <entry>Pending</entry>

                          <entry>Matches are continuing and curent match is
                          supplied</entry>

                          <entry>FF00</entry>

                          <entry>Indicates that the search for further matches
                          is continuing. This is returned when each successful
                          match is returned and when further matches are
                          forthcoming. Pending indication message is output to
                          the Service Log.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table></para>
              </section>

              <section>
                <title>Specific Conformance for Query SOP Classes</title>

                <para>Exported SOP Instances are always updated with the
                latest values kept in the database prior to export.<table>
                    <title>dcm4che/archive Query/Retrieve Server C-MOVE
                    Response Status</title>

                    <tgroup align="left" cols="4">
                      <colspec colwidth="40" />

                      <colspec colwidth="80" />

                      <colspec colwidth="40" />

                      <thead>
                        <row valign="middle">
                          <entry>Service Status</entry>

                          <entry>Further Meaning</entry>

                          <entry>Error Code</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Success</entry>

                          <entry>Success</entry>

                          <entry>0000</entry>

                          <entry>Matching is complete. No final identifier is
                          supplied</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Processing Failure</entry>

                          <entry>0110</entry>

                          <entry>This status is returned due to internal
                          errors such as a processing failure response on an
                          query of the internal database. The appropriate
                          Status will be sent in the C-MOVE Response. Error
                          indication message is output to the Service
                          Log.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Unable to perform sub-operations</entry>

                          <entry>A702</entry>

                          <entry>C-STORE sub-operations cannot be performed
                          due to failure of an Association Request or a
                          C-STORE Request. Error indication message is output
                          to the Service Log.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Move Destination unknown</entry>

                          <entry>A801</entry>

                          <entry>The Destination Application Entity named in
                          the C-MOVE Request is unknown to Query/Retrieve SCP
                          AE. Error indication message is output to the
                          Service Log.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Identifier does not match SOP Class</entry>

                          <entry>A900</entry>

                          <entry>The C-MOVE identifier contains invalid
                          Elements or values, or is missing mandatory Elements
                          or values for the specified SOP Class or retrieval
                          level. Error indication message is output to the
                          Service Log.</entry>
                        </row>

                        <row>
                          <entry>Error</entry>

                          <entry>Unable to process</entry>

                          <entry>Cxxx</entry>

                          <entry>The Move Destination AET is missing in the
                          C-MOVE Request. Error indication message is output
                          to the Service Log.</entry>
                        </row>

                        <row>
                          <entry>Pending</entry>

                          <entry>Matches are continuing and curent match is
                          supplied</entry>

                          <entry>FF00</entry>

                          <entry>Indicates that the search for further matches
                          is continuing. This is returned when each successful
                          match is returned and when further matches are
                          forthcoming. Pending indication message is output to
                          the Service Log.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table></para>

                <para><table>
                    <title>dcm4che/archive Query/Retrieve Server Service
                    Communication Failure Behavior</title>

                    <tgroup align="left" cols="2">
                      <colspec colwidth="50%" />

                      <colspec colwidth="50%" />

                      <thead>
                        <row valign="middle">
                          <entry>Exception</entry>

                          <entry>Behavior</entry>
                        </row>
                      </thead>

                      <tbody>
                        <row>
                          <entry>Timeout expiry for an expected DICOM Message
                          Request (DIMSE level timeout). I.e. the
                          Query/Retrieve Server SCP AE is waiting for the next
                          C-FIND or C-MOVE Request on an open Association but
                          the timer expires.</entry>

                          <entry>The Association is aborted by issuing a DICOM
                          A-ABORT. Error message is output to the Service
                          Log.</entry>
                        </row>

                        <row>
                          <entry>Timeout expiry for an expected DICOM PDU or
                          TCP/ IP packet (Low-level timeout). I.e. The
                          Query/Retrieve Server AE is waiting for the next
                          message PDU but the timer expires.</entry>

                          <entry>The Association is aborted by issuing a DICOM
                          A-ABORT. Error message is output to the Service
                          Log.</entry>
                        </row>

                        <row>
                          <entry>Association aborted by the SCU or the network
                          layers indicate communication loss (i.e. low-level
                          TCP/IP socket closure)</entry>

                          <entry>Error message is output to the Service
                          Log.</entry>
                        </row>
                      </tbody>
                    </tgroup>
                  </table></para>
              </section>
            </section>
          </section>
        </section>
      </section>

      <section>
        <title>dcm4che/archive Modality Worklist Server Application Entity
        Specification</title>

        <section>
          <title>SOP Classes</title>

          <para>dcm4che/archive Modality Worklist Server Application Entity
          provides Standard Conformance to the following SOP Classes:<table>
              <title>SOP Classes for dcm4che/archive Modality Worklist Server
              AE</title>

              <tgroup align="left" cols="4">
                <colspec align="left" colname="c1" />

                <colspec align="left" colname="c2" colwidth="120" />

                <colspec align="center" colname="c3" colwidth="25" />

                <colspec align="center" colname="c4" colwidth="25" />

                <thead>
                  <row>
                    <entry>SOP Class Name</entry>

                    <entry>SOP Class UID</entry>

                    <entry>SCU</entry>

                    <entry>SCP</entry>
                  </row>
                </thead>

                <tbody>
                  <row>
                    <entry>Verification SOP Class</entry>

                    <entry>1.2.840.10008.1.1</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>

                  <row>
                    <entry>Modality Worklist Information Model - FIND</entry>

                    <entry>1.2.840.10008.5.1.4.31</entry>

                    <entry>No</entry>

                    <entry>Yes</entry>
                  </row>
                </tbody>
              </tgroup>
            </table></para>
        </section>

        <section>
          <title>Association Establishment Policy</title>

          <section>
            <title>General</title>

            <para>dcm4che/archive Modality Worklist Server AE can both accept
            and propose Association Requests. The Query/Retrieve Server AE
            will accept Association Requests for the Verification and
            Query/Retrieve Services. It will propose Associations for
            Verification and Storage Services.</para>

            <para>The DICOM standard application context name for DICOM 3.0 is
            always accepted and proposed:</para>

            <para><table>
                <title>DICOM application context name for dcm4che/archive
                Modality Worklist Server AE</title>

                <tgroup align="left" cols="2">
                  <tbody>
                    <row>
                      <entry>Application Context Name</entry>

                      <entry>1.2.840.10008.3.1.1.1</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>
          </section>

          <section>
            <title>Number of Associations</title>

            <para>dcm4che/archive Modality Worklist Server can support
            multiple simultaneous Associations requested by peer AEs. Default
            is 10. This value can be configured through the attribute
            "MaxClients" in the Application Server configuration file (i.e.
            jboss-service.xml for JBoss application seerver).</para>

            <table>
              <title>Number of Associations accepted for dcm4che/archive
              Modality Worklist Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of simultaneous Associations</entry>

                    <entry>10 (Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Asynchronous Nature</title>

            <para>dcm4che/archive Modality Worklist Server does not support
            asynchronous communication. Multiple outstanding transactions are
            not supported. It allows up to one invoked and one performed
            operation on an Association (it is synchronous). Asynchronous mode
            of operation is not supported.</para>

            <table>
              <title>Asynchronous Nature as SCP for dcm4che/archive Modality
              Worklist Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Maximum number of outstanding asynchronous
                    transactions</entry>

                    <entry>1 (Not Configurable)</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>

          <section>
            <title>Implementation Identifying Information</title>

            <para>The implementation information for this Application Entity
            is:</para>

            <table>
              <title>DICOM Implementation Class and Version for
              dcm4che/archive Modality Worklist Server AE</title>

              <tgroup align="left" cols="2">
                <tbody>
                  <row>
                    <entry>Implementation Class UID</entry>

                    <entry>1.2.40.0.13.1.1</entry>
                  </row>

                  <row>
                    <entry>Implementation Version Name</entry>

                    <entry>dcm4che-1.1</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </section>
        </section>

        <section>
          <title>Association Initiation Policy</title>

          <para>The Modality Worklist Server AE does not initiate
          Associations.</para>
        </section>

        <section>
          <title>Association Acceptance Policy</title>

          <section>
            <title>Activity - External Peer AE requests MWL query</title>
          </section>

          <section>
            <title>Description and Sequencing of Activities</title>

            <para>The Modality Worklist Server AE accepts Associations only if
            they have valid Presentation Contexts. If none of the requested
            Presentation Contexts are accepted then the Association Request
            itself is rejected. It can be configured to only accept
            Associations from certain Application Entities.</para>

            <para>When Modality Worklist SCUs query the Modality Worklist
            Server AE the queries run against the MWL items in the local
            database.</para>

            <para>When an association has been established the Sequencing of
            Real-World Activities is as described in <xref
            linkend="s-sequencing" />.</para>

            <para>The Modality Worklist Server AE may reject Association
            attempts as shown in the table below. The Result, Source and
            Reason / Diag columns represent the values returned in the
            corresponding fields of an ASSOCIATE-RJ PDU (see PS 3.8, Section
            9.3.4).<table>
                <title>Association Rejection Reasons</title>

                <tgroup align="left" cols="4">
                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <colspec colwidth="60" />

                  <thead>
                    <row>
                      <entry>Result</entry>

                      <entry>Source</entry>

                      <entry>Reason</entry>

                      <entry>Description</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>2 - rejected transient</entry>

                      <entry>provider</entry>

                      <entry>2 - local-limit exceeded</entry>

                      <entry>The (configurable) maximum number of simultaneous
                      associations has been reached. An association request
                      with the same parameters may succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>2 - application context name not
                      supported</entry>

                      <entry>The Association request contained an unsupported
                      Application Context Name. An association request with
                      the same parameters will NOT succeed at a later
                      time.</entry>
                    </row>

                    <row>
                      <entry>1 - rejected permanent</entry>

                      <entry>user</entry>

                      <entry>3 – calling AE title not recognized</entry>

                      <entry>The Association request contained an unrecognized
                      Calling AE Title. An association request with the same
                      parameters will NOT succeed at a later time unless
                      configuration changes are made.</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>
          </section>

          <section>
            <title>Accepted Presentation Contexts</title>

            <para><table>
                <title>Accepted Presentation Contexts for dcm4che/archive
                Query/Retrieve Server AE</title>

                <tgroup align="left" cols="6">
                  <colspec colname="c1" />

                  <colspec colname="c2" colwidth="110" />

                  <colspec colname="c3" colwidth="60" />

                  <colspec colname="c4" colwidth="90" />

                  <colspec align="center" colname="c5" colwidth="30" />

                  <colspec align="center" colname="c6" colwidth="30" />

                  <spanspec align="center" nameend="c2" namest="c1"
                            spanname="s12" />

                  <spanspec align="center" nameend="c4" namest="c3"
                            spanname="s34" />

                  <thead>
                    <row valign="middle">
                      <entry spanname="s12">Abstract Syntax</entry>

                      <entry spanname="s34">Transfer Syntax</entry>

                      <entry morerows="1">Role</entry>

                      <entry morerows="1">Ext. Neg.</entry>
                    </row>

                    <row>
                      <entry>Name</entry>

                      <entry>UID</entry>

                      <entry>Name List</entry>

                      <entry>UID List</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Verification SOP Class</entry>

                      <entry>1.2.840.10008.1.1</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry>SCP</entry>

                      <entry>None</entry>
                    </row>

                    <row>
                      <entry morerows="1">Modality Worklist Information Model
                      – FIND</entry>

                      <entry morerows="1">1.2.840.10008.5.1.4.31</entry>

                      <entry>Implicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2</entry>

                      <entry morerows="1">SCP</entry>

                      <entry morerows="1">None</entry>
                    </row>

                    <row>
                      <entry>Explicit VR Little Endian</entry>

                      <entry>1.2.840.10008.1.2.1</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>

            <para>If the Called AET is not corresponding to the actual
            Modality Worklist Server AET, only the Presentation Context for
            the Verification SOP Class will be accepted.</para>
          </section>

          <section>
            <title>SOP Specific Conformance</title>

            <para></para>
          </section>

          <section>
            <title>Specific Conformance for Verification SOP Class</title>

            <para>dcm4che/archive Storage Server provides standard conformance
            to the DICOM Verification Service Class as a SCP. The status code
            for the C-ECHO is described in the following table:</para>

            <para><table>
                <title>C-Echo Response Status Handling Behavior</title>

                <tgroup align="left" cols="4">
                  <colspec colwidth="40" />

                  <colspec colwidth="100" />

                  <colspec colwidth="40" />

                  <thead>
                    <row valign="middle">
                      <entry>Service Status</entry>

                      <entry>Further Meaning</entry>

                      <entry>Error Code</entry>

                      <entry>Behavior</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Success</entry>

                      <entry>Success</entry>

                      <entry>0000</entry>

                      <entry>The C-ECHO request is accepted</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>
          </section>

          <section>
            <title>Specific Conformance for Modality Worklist SOP
            Class</title>

            <para>Return attributes depend on the information provided by the
            connected HIS/RIS. There are no attributes always returned by
            default. Only those attributes requested in the query identifier
            are returned. Query responses always return values from the
            Modality Worklist Server database.<table>
                <title>Modality Worklist C-FIND SCP Supported Elements</title>

                <tgroup align="left" cols="4">
                  <colspec colname="c1" colwidth="200" />

                  <colspec align="left" colname="c2" colwidth="60" />

                  <colspec align="left" colname="c3" colwidth="40" />

                  <colspec colname="c4" />

                  <spanspec nameend="c4" namest="c1" spanname="c1-4" />

                  <thead>
                    <row valign="middle">
                      <entry>Attribute Name</entry>

                      <entry>Tag</entry>

                      <entry>VR</entry>

                      <entry>Types of Matching</entry>
                    </row>
                  </thead>

                  <tbody>
                    <row>
                      <entry>Specific Character Set</entry>

                      <entry>0008,0005</entry>

                      <entry>CS</entry>

                      <entry>NONE</entry>
                    </row>

                    <row>
                      <entry>Scheduled station AE title</entry>

                      <entry>0040,0001</entry>

                      <entry>AE</entry>

                      <entry>S</entry>
                    </row>

                    <row>
                      <entry>Scheduled Procedure Step Start Date</entry>

                      <entry>0040,0002</entry>

                      <entry>DA</entry>

                      <entry>S,R</entry>
                    </row>

                    <row>
                      <entry>Scheduled Procedure Step Start Time</entry>

                      <entry>0040,0003</entry>

                      <entry>TM</entry>

                      <entry>S,R</entry>
                    </row>

                    <row>
                      <entry>Scheduled Performing Physician's Name</entry>

                      <entry>0040,0006</entry>

                      <entry>PN</entry>

                      <entry>S,*</entry>
                    </row>

                    <row>
                      <entry>Modality</entry>

                      <entry>0008,0060</entry>

                      <entry>CS</entry>

                      <entry>S</entry>
                    </row>

                    <row>
                      <entry>Accession Number</entry>

                      <entry>0008,0050</entry>

                      <entry>SH</entry>

                      <entry>S</entry>
                    </row>

                    <row>
                      <entry>Patient's Name</entry>

                      <entry>0010,0010</entry>

                      <entry>PN</entry>

                      <entry>S,*</entry>
                    </row>

                    <row>
                      <entry>Patient's ID</entry>

                      <entry>0010,0020</entry>

                      <entry>LO</entry>

                      <entry>S</entry>
                    </row>

                    <row>
                      <entry>All others</entry>

                      <entry></entry>

                      <entry></entry>

                      <entry>NONE</entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></para>

            <para>Types of Matching:</para>

            <para>The types of Matching supported by the C-FIND SCP. An "S"
            indicates the identifier attribute uses Single Value Matching, an
            "R" indicates Range Matching, an "*" indicates wildcard matching,
            a "U" indicates Universal Matching. "NONE" indicates that no
            matching is supported, but that values for this Element are
            requested to be returned.</para>

            <section>
              <title>Modality Worklist Server AE C-STORE Response</title>

              <para><table>
                  <title>dcm4che/archive Modality Worklist Server C-STORE
                  Response Status</title>

                  <tgroup align="left" cols="4">
                    <colspec colwidth="40" />

                    <colspec colwidth="80" />

                    <colspec colwidth="40" />

                    <thead>
                      <row valign="middle">
                        <entry>Service Status</entry>

                        <entry>Further Meaning</entry>

                        <entry>Error Code</entry>

                        <entry>Behavior</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry>Success</entry>

                        <entry>Matching is complete</entry>

                        <entry>0000</entry>

                        <entry>Success indication message is output to the
                        Service Log.</entry>
                      </row>

                      <row>
                        <entry>Error</entry>

                        <entry>Processing Failure</entry>

                        <entry>0110</entry>

                        <entry>This is treated as a permanent Failure. The
                        appropriate Status will be sent in the C-FIND
                        Response. Error indication message is output to the
                        Service Log.</entry>
                      </row>

                      <row>
                        <entry>Canceled</entry>

                        <entry>Matching terminated due to cancel
                        request</entry>

                        <entry>FE00</entry>

                        <entry>This status is returned if a Cancel Request is
                        received from the SCU during the processing of a
                        Modality Worklist request. A cancel indication message
                        is output to the Service Log.</entry>
                      </row>

                      <row>
                        <entry>Pending</entry>

                        <entry>Matching is continuing</entry>

                        <entry>FF00</entry>

                        <entry>This status is returned with each matching
                        response. A pending indication message is output to
                        the Service Log.</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table></para>
            </section>

            <section>
              <title>Modality Server AE Storage Service Communication Failure
              Reasons</title>

              <para><table>
                  <title>dcm4che/archive Modality Server Service Communication
                  Failure Behavior</title>

                  <tgroup align="left" cols="2">
                    <colspec colwidth="50%" />

                    <colspec colwidth="50%" />

                    <thead>
                      <row valign="middle">
                        <entry>Exception</entry>

                        <entry>Behavior</entry>
                      </row>
                    </thead>

                    <tbody>
                      <row>
                        <entry>Association aborted by the SCU or the network
                        layers indicate communication loss (i.e. low-level
                        TCP/IP socket closure)</entry>

                        <entry>Error message is output to the Service
                        Log.</entry>
                      </row>
                    </tbody>
                  </tgroup>
                </table></para>
            </section>
          </section>
        </section>
      </section>

      <section>
        <title>dcm4che/archive MPPS Manager Application Entity
        Specification</title>

        <section>
          <title>SOP Classes</title>
        </section>

        <section>
          <title>Association Establishment Policy</title>
        </section>

        <section>
          <title>Association Initiation Policy</title>
        </section>

        <section>
          <title>Association Acceptance Policy</title>
        </section>
      </section>

      <section>
        <title>dcm4che/archive IAN/SCN Service Application Entity
        Specification</title>

        <section>
          <title>SOP Classes</title>
        </section>

        <section>
          <title>Association Establishment Policy</title>
        </section>

        <section>
          <title>Association Initiation Policy</title>
        </section>

        <section>
          <title>Association Acceptance Policy</title>
        </section>
      </section>
    </section>

    <section>
      <title>Physical Network Interfaces</title>

      <section>
        <title>Supported Communication Stacks</title>

        <para>DICOM Upper Layer over TCP/IP is supported.</para>

        <section>
          <title>TCP/IP Stack</title>

          <para>dcm4che/archive inherits their TCP/IP stack from the installed
          Java Runtime Environment.</para>
        </section>
      </section>

      <section>
        <title>Physical Network Interface</title>

        <para>dcm4che/archive is indifferent to the physical medium over which
        TCP/IP executes; it inherits this from the Java Runtime
        Environment.</para>
      </section>
    </section>

    <section>
      <title>Configuration</title>

      <section>
        <title>AE Title/Presentation Address Mapping</title>

        <section>
          <title>Local AE Titles</title>

          <para>The local AE Titles and TCP ports are configurable through web
          interface.<table>
              <title>AE Title Configuration Table</title>

              <tgroup align="left" cols="3">
                <colspec colwidth="100" />

                <colspec colwidth="100" />

                <colspec colwidth="100" />

                <thead>
                  <row>
                    <entry>Application Entity</entry>

                    <entry>Default AE Title</entry>

                    <entry>Default TCP/IP Port</entry>
                  </row>
                </thead>

                <tbody>
                  <row>
                    <entry>dcm4che/archive Storage Server</entry>

                    <entry>STORE_SCP</entry>

                    <entry>2350</entry>
                  </row>

                  <row>
                    <entry>dcm4che/archive Query/Retrieve Server</entry>

                    <entry>QR_SCP</entry>

                    <entry>2350</entry>
                  </row>

                  <row>
                    <entry>dcm4che/archive Modality Worklist Server</entry>

                    <entry>MWL_SCP</entry>

                    <entry>2350</entry>
                  </row>

                  <row>
                    <entry>dcm4che/archive MPPS Manager</entry>

                    <entry>MPPS_MGR</entry>

                    <entry>2350</entry>
                  </row>
                </tbody>
              </tgroup>
            </table></para>
        </section>

        <section>
          <title>Remote AE Title</title>

          <para>Remote AE Titles, TCP/IP Addresses and ports can be configured
          through web interface.</para>

          <para>In the default configuration, Association Requests with any
          Calling AET will be accepted.</para>
        </section>
      </section>

      <section>
        <title>Parameters</title>

        <para>The following table shows the dcm4che configuration parameters
        relevant to DICOM communication. Refer to the dcm4che/archive Service
        Manual for details on general configuration capabilities.</para>

        <para><table>
            <title>Configuration Parameter Table</title>

            <tgroup align="left" cols="3">
              <colspec align="left" colname="c1" />

              <colspec align="center" colname="c2" colwidth="70" />

              <colspec colname="c3" colwidth="100" />

              <spanspec align="center" nameend="c3" namest="c1"
                        spanname="c1-c3" />

              <thead>
                <row valign="middle">
                  <entry>Parameter</entry>

                  <entry>Configurable (Yes/No)</entry>

                  <entry>Default Value</entry>
                </row>
              </thead>

              <tbody>
                <row>
                  <entry spanname="c1-c3">General Parameters</entry>
                </row>

                <row>
                  <entry>Listening Port</entry>

                  <entry>Yes</entry>

                  <entry>2351</entry>
                </row>

                <row>
                  <entry>Maximum number of simultaneous Associations</entry>

                  <entry>Yes</entry>

                  <entry>10</entry>
                </row>

                <row>
                  <entry>Time-out waiting for A-ASSOCIATE RQ on open TCP/IP
                  connection (ARTIM timeout)</entry>

                  <entry>Yes</entry>

                  <entry>5s</entry>
                </row>

                <row>
                  <entry>Time-out waiting on an open association for the next
                  message (DIMSE timeout)</entry>

                  <entry>Yes</entry>

                  <entry>no timeout</entry>
                </row>

                <row>
                  <entry>Time-out waiting for acceptance or rejection Response
                  to an Association Open Request. (Application Level
                  timeout)</entry>

                  <entry>No</entry>

                  <entry>no timeout</entry>
                </row>

                <row>
                  <entry>Time-out waiting on an open association for the next
                  message after sending A-RELEASE RSP or A-ABORT RQ (Closíng
                  timeout)</entry>

                  <entry>Yes</entry>

                  <entry>500ms</entry>
                </row>

                <row>
                  <entry>Maximum PDU size the AE can receive</entry>

                  <entry>Yes</entry>

                  <entry>16352</entry>
                </row>

                <row>
                  <entry>Maximum PDU size the AE can send</entry>

                  <entry>No</entry>

                  <entry>65535</entry>
                </row>

                <row>
                  <entry>Pack Command and Data PDVs in one PDU</entry>

                  <entry>Yes</entry>

                  <entry>false</entry>
                </row>

                <row>
                  <entry>Support for the Basic TLS Secure Transport Connection
                  Profile</entry>

                  <entry>Yes</entry>

                  <entry>Off</entry>
                </row>

                <row>
                  <entry>Accepted TLS Ciphers</entry>

                  <entry>Yes</entry>

                  <entry>-</entry>
                </row>

                <row>
                  <entry spanname="c1-c3">Storage Server AE</entry>
                </row>

                <row>
                  <entry>Accepted Called AETs</entry>

                  <entry>Yes</entry>

                  <entry>STORE_SCP</entry>
                </row>

                <row>
                  <entry>Accepted Calling AETs</entry>

                  <entry>Yes</entry>

                  <entry>any</entry>
                </row>

                <row>
                  <entry>List of DICOM AETs that identify the location from
                  which composite object instance(s) received by this Storage
                  Server may be retrieved on the network</entry>

                  <entry>Yes</entry>

                  <entry>QR_SCP</entry>
                </row>

                <row>
                  <entry>Storage Directory Path Prefix</entry>

                  <entry>Yes</entry>

                  <entry>/archive</entry>
                </row>

                <row>
                  <entry>Time-out waiting for the A-ASSOCIATE-AC PDU after
                  transmission of the A-ASSOCIATE-RQ to open an association to
                  the Storage Commitment SCU</entry>

                  <entry>Yes</entry>

                  <entry>5s</entry>
                </row>

                <row>
                  <entry spanname="c1-c3">Query/Retrieve Server AE</entry>
                </row>

                <row>
                  <entry>Accepted Called AETs</entry>

                  <entry>Yes</entry>

                  <entry>QR_SCP</entry>
                </row>

                <row>
                  <entry>Accepted Calling AETs</entry>

                  <entry>Yes</entry>

                  <entry>any</entry>
                </row>

                <row>
                  <entry>Send optional C-MOVE RSPs with Pending Status to the
                  C-MOVE SCU during the retrieve process</entry>

                  <entry>Yes</entry>

                  <entry>true</entry>
                </row>

                <row>
                  <entry>Time-out waiting for the A-ASSOCIATE-AC PDU after
                  transmission of the A-ASSOCIATE-RQ to open an association to
                  the Move Destination AE</entry>

                  <entry>Yes</entry>

                  <entry>5s</entry>
                </row>

                <row>
                  <entry spanname="c1-c3">Modality Worklist Server AE</entry>
                </row>

                <row>
                  <entry>Accepted Called AETs</entry>

                  <entry>Yes</entry>

                  <entry>MWL_SCP</entry>
                </row>

                <row>
                  <entry>Accepted Calling AETs</entry>

                  <entry>Yes</entry>

                  <entry>any</entry>
                </row>

                <row>
                  <entry spanname="c1-c3">MPPS Manager AE</entry>
                </row>

                <row>
                  <entry>Accepted Called AETs</entry>

                  <entry>Yes</entry>

                  <entry>MPPS_SCP</entry>
                </row>

                <row>
                  <entry>Accepted Calling AETs</entry>

                  <entry>Yes</entry>

                  <entry>any</entry>
                </row>

                <row>
                  <entry>MPPS Forward AET</entry>

                  <entry>Yes</entry>

                  <entry>-</entry>
                </row>

                <row>
                  <entry>Time-out waiting for the A-ASSOCIATE-AC PDU after
                  transmission of the A-ASSOCIATE-RQ to open an association to
                  the MPPS Forward SCP AE</entry>

                  <entry>Yes</entry>

                  <entry>5s</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </section>
    </section>
  </section>

  <section>
    <title>Media Interchange</title>

    <para>dm4che does not support Media Storage.</para>
  </section>

  <section>
    <title>Support of Extended Character Sets</title>

    <para>dm4che supports ISO_IR 100 (ISO 8859-1 Latin 1) as an extended
    character set.</para>
  </section>

  <section>
    <title>Security</title>

    <section>
      <title>Security Profiles</title>

      <para>dcm4che/archive supports secure DICOM communication in conformance
      with the Basic TLS Secure Transport Connection Profile. At default
      configuration, the TLS option is deactivated.</para>
    </section>

    <section>
      <title>Association Level Security</title>

      <para>dcm4che/archive can be configured to accept Association Requests
      from only a limited list of Calling AE Titles.</para>

      <para>In the default configuration, Association requests with any
      Calling AET and any Called AET will be accepted. However, if the Called
      AET is not correspondent to any of the actual Storage Server AETs, only
      acceptance of the Presentation Context for Verification SOP Class will
      be returned in the Association Acceptance Response (A-ASSOCIATE
      AC).</para>
    </section>

    <section>
      <title>Application Level Security</title>

      <para>dcm4che/archive web module can be configured to require user
      authentication in order to access to the user interface
      functionalities.</para>
    </section>
  </section>

  <section>
    <title>Annexes</title>

    <section>
      <title>Created IOD Instances</title>

      <para>does not create SOP Instances.</para>

      <para></para>
    </section>

    <section>
      <title>Usage of Attributes from received IOD’s</title>

      <para></para>
    </section>

    <section>
      <title>Attribute Mapping</title>

      <para></para>
    </section>

    <section>
      <title>Coerced/Modified Fields</title>

      <para>Attribute coercion is configurable for IOD’s received by the
      Storage Server. Attributes can either be mapped or may be filled with
      “fixed values” depending on the existence or the content(s) of one or
      more other Attributes.</para>

      <para>Patient Information, Patient Demographics and Study Information
      could either be modified manually using the web based system management
      tool or updated automatically by information received from
      HIS/RIS.</para>

      <para>The coerced/modified Attribute values are provided when a remote
      Query/Retrieve SCU queries information or when SOP Instances are sent to
      a remote Storage SCP. Attribute Coercion will be indicated in the
      appropriate Service Response Status.</para>
    </section>
  </section>

  <section>
    <title>Appendix A. Implementation Statements of IHE Integration
    Profiles</title>

    <para><phrase> dcm4che/archive has implemented the following DICOM service
    classes and HL7 messages:</phrase></para>

    <itemizedlist>
      <listitem>
        <para>DICOM XY Image Storage SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Grayscale Softcopy Presentation State Storage
        SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Key Object Selection Document SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Basic Text SR Storage SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Enhanced SR Storage SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Comprehensive SR Storage SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Storage Commitment Push Model SOP Class SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Modality Performed Procedure Step SOP Class SCU+SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Study Root Query/Retrieve Information Model - FIND
        SCP</para>
      </listitem>

      <listitem>
        <para>DICOM Study Root Query/Retrieve Information Model - MOVE
        SCP</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A02 (Patient Transfer) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A03 (Patient Discharge) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A06 (Change an Outpatient to an Inpatient) message
        receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A07 (Change an Inpatient to an Outpatient) message
        receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A08 (Update Patient Information) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A40 (Merge Patient Internal ID) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A12 (Cancel Patient Transfer) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ADT^A13 (Cancel Patient Discharge) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ORM (Procedure Scheduled) message receive</para>
      </listitem>

      <listitem>
        <para>HL7 ORM (Procedure Updated) message receive</para>
      </listitem>
    </itemizedlist>

    <para>according to the following IHE Integration Profiles:</para>

    <itemizedlist>
      <listitem>
        <para>Scheduled Workflow Integration Profile</para>
      </listitem>

      <listitem>
        <para>Patient Information Reconciliation Integration Profile</para>
      </listitem>

      <listitem>
        <para>Consistent Presentation of Images Integration Profile</para>
      </listitem>

      <listitem>
        <para>Access to Radiology Information Integration Profile</para>
      </listitem>

      <listitem>
        <para>Key Image Note Integration Profile</para>
      </listitem>

      <listitem>
        <para>Simple Image and Numeric Report Integration Profile</para>
      </listitem>

      <listitem>
        <para>Basic Security Intergration Profile</para>
      </listitem>
    </itemizedlist>

    <para>and supports the following IHE Actors:</para>

    <itemizedlist>
      <listitem>
        <para>Image Manager/Image Archive</para>
      </listitem>

      <listitem>
        <para>Performed Procedure Step Manager</para>
      </listitem>

      <listitem>
        <para>Report Repository</para>
      </listitem>

      <listitem>
        <para>Secure Node</para>
      </listitem>
    </itemizedlist>

    <para><phrase> </phrase></para>
  </section>
</article>